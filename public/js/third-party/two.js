(function(){function t(t){function e(e,i,r,n,s,a){for(;s>=0&&s<a;s+=t){var o=n?n[s]:s;r=i(r,e[o],o,e)}return r}return function(i,r,n,s){r=v(r,s,4);var a=!S(i)&&y.keys(i),o=(a||i).length,l=t>0?0:o-1;return arguments.length<3&&(n=i[a?a[l]:l],l+=t),e(i,r,n,a,l,o)}}function e(t){return function(e,i,r){i=b(i,r);for(var n=E(e),s=t>0?0:n-1;s>=0&&s<n;s+=t)if(i(e[s],s,e))return s;return-1}}function i(t,e,i){return function(r,n,s){var a=0,o=E(r);if("number"==typeof s)t>0?a=s>=0?s:Math.max(s+o,a):o=s>=0?Math.min(s+1,o):s+o+1;else if(i&&s&&o)return s=i(r,n),r[s]===n?s:-1;if(n!==n)return s=e(c.call(r,a,o),y.isNaN),s>=0?s+a:-1;for(s=t>0?a:o-1;s>=0&&s<o;s+=t)if(r[s]===n)return s;return-1}}function r(t,e){var i=P.length,r=t.constructor,n=y.isFunction(r)&&r.prototype||o,s="constructor";for(y.has(t,s)&&!y.contains(e,s)&&e.push(s);i--;)s=P[i],s in t&&t[s]!==n[s]&&!y.contains(e,s)&&e.push(s)}var n=this,s=n._,a=Array.prototype,o=Object.prototype,l=Function.prototype,h=a.push,c=a.slice,u=o.toString,f=o.hasOwnProperty,d=Array.isArray,p=Object.keys,g=l.bind,_=Object.create,m=function(){},y=function(t){return t instanceof y?t:this instanceof y?void(this._wrapped=t):new y(t)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=y),exports._=y):n._=y,y.VERSION="1.8.3";var v=function(t,e,i){if(void 0===e)return t;switch(null==i?3:i){case 1:return function(i){return t.call(e,i)};case 2:return function(i,r){return t.call(e,i,r)};case 3:return function(i,r,n){return t.call(e,i,r,n)};case 4:return function(i,r,n,s){return t.call(e,i,r,n,s)}}return function(){return t.apply(e,arguments)}},b=function(t,e,i){return null==t?y.identity:y.isFunction(t)?v(t,e,i):y.isObject(t)?y.matcher(t):y.property(t)};y.iteratee=function(t,e){return b(t,e,1/0)};var x=function(t,e){return function(i){var r=arguments.length;if(r<2||null==i)return i;for(var n=1;n<r;n++)for(var s=arguments[n],a=t(s),o=a.length,l=0;l<o;l++){var h=a[l];e&&void 0!==i[h]||(i[h]=s[h])}return i}},A=function(t){if(!y.isObject(t))return{};if(_)return _(t);m.prototype=t;var e=new m;return m.prototype=null,e},w=function(t){return function(e){return null==e?void 0:e[t]}},k=Math.pow(2,53)-1,E=w("length"),S=function(t){var e=E(t);return"number"==typeof e&&e>=0&&e<=k};y.each=y.forEach=function(t,e,i){e=v(e,i);var r,n;if(S(t))for(r=0,n=t.length;r<n;r++)e(t[r],r,t);else{var s=y.keys(t);for(r=0,n=s.length;r<n;r++)e(t[s[r]],s[r],t)}return t},y.map=y.collect=function(t,e,i){e=b(e,i);for(var r=!S(t)&&y.keys(t),n=(r||t).length,s=Array(n),a=0;a<n;a++){var o=r?r[a]:a;s[a]=e(t[o],o,t)}return s},y.reduce=y.foldl=y.inject=t(1),y.reduceRight=y.foldr=t(-1),y.find=y.detect=function(t,e,i){var r;if(r=S(t)?y.findIndex(t,e,i):y.findKey(t,e,i),void 0!==r&&r!==-1)return t[r]},y.filter=y.select=function(t,e,i){var r=[];return e=b(e,i),y.each(t,function(t,i,n){e(t,i,n)&&r.push(t)}),r},y.reject=function(t,e,i){return y.filter(t,y.negate(b(e)),i)},y.every=y.all=function(t,e,i){e=b(e,i);for(var r=!S(t)&&y.keys(t),n=(r||t).length,s=0;s<n;s++){var a=r?r[s]:s;if(!e(t[a],a,t))return!1}return!0},y.some=y.any=function(t,e,i){e=b(e,i);for(var r=!S(t)&&y.keys(t),n=(r||t).length,s=0;s<n;s++){var a=r?r[s]:s;if(e(t[a],a,t))return!0}return!1},y.contains=y.includes=y.include=function(t,e,i,r){return S(t)||(t=y.values(t)),("number"!=typeof i||r)&&(i=0),y.indexOf(t,e,i)>=0},y.invoke=function(t,e){var i=c.call(arguments,2),r=y.isFunction(e);return y.map(t,function(t){var n=r?e:t[e];return null==n?n:n.apply(t,i)})},y.pluck=function(t,e){return y.map(t,y.property(e))},y.where=function(t,e){return y.filter(t,y.matcher(e))},y.findWhere=function(t,e){return y.find(t,y.matcher(e))},y.max=function(t,e,i){var r,n,s=-(1/0),a=-(1/0);if(null==e&&null!=t){t=S(t)?t:y.values(t);for(var o=0,l=t.length;o<l;o++)r=t[o],r>s&&(s=r)}else e=b(e,i),y.each(t,function(t,i,r){n=e(t,i,r),(n>a||n===-(1/0)&&s===-(1/0))&&(s=t,a=n)});return s},y.min=function(t,e,i){var r,n,s=1/0,a=1/0;if(null==e&&null!=t){t=S(t)?t:y.values(t);for(var o=0,l=t.length;o<l;o++)r=t[o],r<s&&(s=r)}else e=b(e,i),y.each(t,function(t,i,r){n=e(t,i,r),(n<a||n===1/0&&s===1/0)&&(s=t,a=n)});return s},y.shuffle=function(t){for(var e,i=S(t)?t:y.values(t),r=i.length,n=Array(r),s=0;s<r;s++)e=y.random(0,s),e!==s&&(n[s]=n[e]),n[e]=i[s];return n},y.sample=function(t,e,i){return null==e||i?(S(t)||(t=y.values(t)),t[y.random(t.length-1)]):y.shuffle(t).slice(0,Math.max(0,e))},y.sortBy=function(t,e,i){return e=b(e,i),y.pluck(y.map(t,function(t,i,r){return{value:t,index:i,criteria:e(t,i,r)}}).sort(function(t,e){var i=t.criteria,r=e.criteria;if(i!==r){if(i>r||void 0===i)return 1;if(i<r||void 0===r)return-1}return t.index-e.index}),"value")};var C=function(t){return function(e,i,r){var n={};return i=b(i,r),y.each(e,function(r,s){var a=i(r,s,e);t(n,r,a)}),n}};y.groupBy=C(function(t,e,i){y.has(t,i)?t[i].push(e):t[i]=[e]}),y.indexBy=C(function(t,e,i){t[i]=e}),y.countBy=C(function(t,e,i){y.has(t,i)?t[i]++:t[i]=1}),y.toArray=function(t){return t?y.isArray(t)?c.call(t):S(t)?y.map(t,y.identity):y.values(t):[]},y.size=function(t){return null==t?0:S(t)?t.length:y.keys(t).length},y.partition=function(t,e,i){e=b(e,i);var r=[],n=[];return y.each(t,function(t,i,s){(e(t,i,s)?r:n).push(t)}),[r,n]},y.first=y.head=y.take=function(t,e,i){if(null!=t)return null==e||i?t[0]:y.initial(t,t.length-e)},y.initial=function(t,e,i){return c.call(t,0,Math.max(0,t.length-(null==e||i?1:e)))},y.last=function(t,e,i){if(null!=t)return null==e||i?t[t.length-1]:y.rest(t,Math.max(0,t.length-e))},y.rest=y.tail=y.drop=function(t,e,i){return c.call(t,null==e||i?1:e)},y.compact=function(t){return y.filter(t,y.identity)};var M=function(t,e,i,r){for(var n=[],s=0,a=r||0,o=E(t);a<o;a++){var l=t[a];if(S(l)&&(y.isArray(l)||y.isArguments(l))){e||(l=M(l,e,i));var h=0,c=l.length;for(n.length+=c;h<c;)n[s++]=l[h++]}else i||(n[s++]=l)}return n};y.flatten=function(t,e){return M(t,e,!1)},y.without=function(t){return y.difference(t,c.call(arguments,1))},y.uniq=y.unique=function(t,e,i,r){y.isBoolean(e)||(r=i,i=e,e=!1),null!=i&&(i=b(i,r));for(var n=[],s=[],a=0,o=E(t);a<o;a++){var l=t[a],h=i?i(l,a,t):l;e?(a&&s===h||n.push(l),s=h):i?y.contains(s,h)||(s.push(h),n.push(l)):y.contains(n,l)||n.push(l)}return n},y.union=function(){return y.uniq(M(arguments,!0,!0))},y.intersection=function(t){for(var e=[],i=arguments.length,r=0,n=E(t);r<n;r++){var s=t[r];if(!y.contains(e,s)){for(var a=1;a<i&&y.contains(arguments[a],s);a++);a===i&&e.push(s)}}return e},y.difference=function(t){var e=M(arguments,!0,!0,1);return y.filter(t,function(t){return!y.contains(e,t)})},y.zip=function(){return y.unzip(arguments)},y.unzip=function(t){for(var e=t&&y.max(t,E).length||0,i=Array(e),r=0;r<e;r++)i[r]=y.pluck(t,r);return i},y.object=function(t,e){for(var i={},r=0,n=E(t);r<n;r++)e?i[t[r]]=e[r]:i[t[r][0]]=t[r][1];return i},y.findIndex=e(1),y.findLastIndex=e(-1),y.sortedIndex=function(t,e,i,r){i=b(i,r,1);for(var n=i(e),s=0,a=E(t);s<a;){var o=Math.floor((s+a)/2);i(t[o])<n?s=o+1:a=o}return s},y.indexOf=i(1,y.findIndex,y.sortedIndex),y.lastIndexOf=i(-1,y.findLastIndex),y.range=function(t,e,i){null==e&&(e=t||0,t=0),i=i||1;for(var r=Math.max(Math.ceil((e-t)/i),0),n=Array(r),s=0;s<r;s++,t+=i)n[s]=t;return n};var F=function(t,e,i,r,n){if(!(r instanceof e))return t.apply(i,n);var s=A(t.prototype),a=t.apply(s,n);return y.isObject(a)?a:s};y.bind=function(t,e){if(g&&t.bind===g)return g.apply(t,c.call(arguments,1));if(!y.isFunction(t))throw new TypeError("Bind must be called on a function");var i=c.call(arguments,2),r=function(){return F(t,r,e,this,i.concat(c.call(arguments)))};return r},y.partial=function(t){var e=c.call(arguments,1),i=function(){for(var r=0,n=e.length,s=Array(n),a=0;a<n;a++)s[a]=e[a]===y?arguments[r++]:e[a];for(;r<arguments.length;)s.push(arguments[r++]);return F(t,i,this,this,s)};return i},y.bindAll=function(t){var e,i,r=arguments.length;if(r<=1)throw new Error("bindAll must be passed function names");for(e=1;e<r;e++)i=arguments[e],t[i]=y.bind(t[i],t);return t},y.memoize=function(t,e){var i=function(r){var n=i.cache,s=""+(e?e.apply(this,arguments):r);return y.has(n,s)||(n[s]=t.apply(this,arguments)),n[s]};return i.cache={},i},y.delay=function(t,e){var i=c.call(arguments,2);return setTimeout(function(){return t.apply(null,i)},e)},y.defer=y.partial(y.delay,y,1),y.throttle=function(t,e,i){var r,n,s,a=null,o=0;i||(i={});var l=function(){o=i.leading===!1?0:y.now(),a=null,s=t.apply(r,n),a||(r=n=null)};return function(){var h=y.now();o||i.leading!==!1||(o=h);var c=e-(h-o);return r=this,n=arguments,c<=0||c>e?(a&&(clearTimeout(a),a=null),o=h,s=t.apply(r,n),a||(r=n=null)):a||i.trailing===!1||(a=setTimeout(l,c)),s}},y.debounce=function(t,e,i){var r,n,s,a,o,l=function(){var h=y.now()-a;h<e&&h>=0?r=setTimeout(l,e-h):(r=null,i||(o=t.apply(s,n),r||(s=n=null)))};return function(){s=this,n=arguments,a=y.now();var h=i&&!r;return r||(r=setTimeout(l,e)),h&&(o=t.apply(s,n),s=n=null),o}},y.wrap=function(t,e){return y.partial(e,t)},y.negate=function(t){return function(){return!t.apply(this,arguments)}},y.compose=function(){var t=arguments,e=t.length-1;return function(){for(var i=e,r=t[e].apply(this,arguments);i--;)r=t[i].call(this,r);return r}},y.after=function(t,e){return function(){if(--t<1)return e.apply(this,arguments)}},y.before=function(t,e){var i;return function(){return--t>0&&(i=e.apply(this,arguments)),t<=1&&(e=null),i}},y.once=y.partial(y.before,2);var q=!{toString:null}.propertyIsEnumerable("toString"),P=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"];y.keys=function(t){if(!y.isObject(t))return[];if(p)return p(t);var e=[];for(var i in t)y.has(t,i)&&e.push(i);return q&&r(t,e),e},y.allKeys=function(t){if(!y.isObject(t))return[];var e=[];for(var i in t)e.push(i);return q&&r(t,e),e},y.values=function(t){for(var e=y.keys(t),i=e.length,r=Array(i),n=0;n<i;n++)r[n]=t[e[n]];return r},y.mapObject=function(t,e,i){e=b(e,i);for(var r,n=y.keys(t),s=n.length,a={},o=0;o<s;o++)r=n[o],a[r]=e(t[r],r,t);return a},y.pairs=function(t){for(var e=y.keys(t),i=e.length,r=Array(i),n=0;n<i;n++)r[n]=[e[n],t[e[n]]];return r},y.invert=function(t){for(var e={},i=y.keys(t),r=0,n=i.length;r<n;r++)e[t[i[r]]]=i[r];return e},y.functions=y.methods=function(t){var e=[];for(var i in t)y.isFunction(t[i])&&e.push(i);return e.sort()},y.extend=x(y.allKeys),y.extendOwn=y.assign=x(y.keys),y.findKey=function(t,e,i){e=b(e,i);for(var r,n=y.keys(t),s=0,a=n.length;s<a;s++)if(r=n[s],e(t[r],r,t))return r},y.pick=function(t,e,i){var r,n,s={},a=t;if(null==a)return s;y.isFunction(e)?(n=y.allKeys(a),r=v(e,i)):(n=M(arguments,!1,!1,1),r=function(t,e,i){return e in i},a=Object(a));for(var o=0,l=n.length;o<l;o++){var h=n[o],c=a[h];r(c,h,a)&&(s[h]=c)}return s},y.omit=function(t,e,i){if(y.isFunction(e))e=y.negate(e);else{var r=y.map(M(arguments,!1,!1,1),String);e=function(t,e){return!y.contains(r,e)}}return y.pick(t,e,i)},y.defaults=x(y.allKeys,!0),y.create=function(t,e){var i=A(t);return e&&y.extendOwn(i,e),i},y.clone=function(t){return y.isObject(t)?y.isArray(t)?t.slice():y.extend({},t):t},y.tap=function(t,e){return e(t),t},y.isMatch=function(t,e){var i=y.keys(e),r=i.length;if(null==t)return!r;for(var n=Object(t),s=0;s<r;s++){var a=i[s];if(e[a]!==n[a]||!(a in n))return!1}return!0};var O=function(t,e,i,r){if(t===e)return 0!==t||1/t===1/e;if(null==t||null==e)return t===e;t instanceof y&&(t=t._wrapped),e instanceof y&&(e=e._wrapped);var n=u.call(t);if(n!==u.call(e))return!1;switch(n){case"[object RegExp]":case"[object String]":return""+t==""+e;case"[object Number]":return+t!==+t?+e!==+e:0===+t?1/+t===1/e:+t===+e;case"[object Date]":case"[object Boolean]":return+t===+e}var s="[object Array]"===n;if(!s){if("object"!=typeof t||"object"!=typeof e)return!1;var a=t.constructor,o=e.constructor;if(a!==o&&!(y.isFunction(a)&&a instanceof a&&y.isFunction(o)&&o instanceof o)&&"constructor"in t&&"constructor"in e)return!1}i=i||[],r=r||[];for(var l=i.length;l--;)if(i[l]===t)return r[l]===e;if(i.push(t),r.push(e),s){if(l=t.length,l!==e.length)return!1;for(;l--;)if(!O(t[l],e[l],i,r))return!1}else{var h,c=y.keys(t);if(l=c.length,y.keys(e).length!==l)return!1;for(;l--;)if(h=c[l],!y.has(e,h)||!O(t[h],e[h],i,r))return!1}return i.pop(),r.pop(),!0};y.isEqual=function(t,e){return O(t,e)},y.isEmpty=function(t){return null==t||(S(t)&&(y.isArray(t)||y.isString(t)||y.isArguments(t))?0===t.length:0===y.keys(t).length)},y.isElement=function(t){return!(!t||1!==t.nodeType)},y.isArray=d||function(t){return"[object Array]"===u.call(t)},y.isObject=function(t){var e=typeof t;return"function"===e||"object"===e&&!!t},y.each(["Arguments","Function","String","Number","Date","RegExp","Error"],function(t){y["is"+t]=function(e){return u.call(e)==="[object "+t+"]"}}),y.isArguments(arguments)||(y.isArguments=function(t){return y.has(t,"callee")}),"function"!=typeof/./&&"object"!=typeof Int8Array&&(y.isFunction=function(t){return"function"==typeof t||!1}),y.isFinite=function(t){return isFinite(t)&&!isNaN(parseFloat(t))},y.isNaN=function(t){return y.isNumber(t)&&t!==+t},y.isBoolean=function(t){return t===!0||t===!1||"[object Boolean]"===u.call(t)},y.isNull=function(t){return null===t},y.isUndefined=function(t){return void 0===t},y.has=function(t,e){return null!=t&&f.call(t,e)},y.noConflict=function(){return n._=s,this},y.identity=function(t){return t},y.constant=function(t){return function(){return t}},y.noop=function(){},y.property=w,y.propertyOf=function(t){return null==t?function(){}:function(e){return t[e]}},y.matcher=y.matches=function(t){return t=y.extendOwn({},t),function(e){return y.isMatch(e,t)}},y.times=function(t,e,i){var r=Array(Math.max(0,t));e=v(e,i,1);for(var n=0;n<t;n++)r[n]=e(n);return r},y.random=function(t,e){return null==e&&(e=t,t=0),t+Math.floor(Math.random()*(e-t+1))},y.now=Date.now||function(){return(new Date).getTime()};var R={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},T=y.invert(R),U=function(t){var e=function(e){return t[e]},i="(?:"+y.keys(t).join("|")+")",r=RegExp(i),n=RegExp(i,"g");return function(t){return t=null==t?"":""+t,r.test(t)?t.replace(n,e):t}};y.escape=U(R),y.unescape=U(T),y.result=function(t,e,i){var r=null==t?void 0:t[e];return void 0===r&&(r=i),y.isFunction(r)?r.call(t):r};var j=0;y.uniqueId=function(t){var e=++j+"";return t?t+e:e},y.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var B=/(.)^/,L={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},N=/\\|'|\r|\n|\u2028|\u2029/g,I=function(t){return"\\"+L[t]};y.template=function(t,e,i){!e&&i&&(e=i),e=y.defaults({},e,y.templateSettings);var r=RegExp([(e.escape||B).source,(e.interpolate||B).source,(e.evaluate||B).source].join("|")+"|$","g"),n=0,s="__p+='";t.replace(r,function(e,i,r,a,o){return s+=t.slice(n,o).replace(N,I),n=o+e.length,i?s+="'+\n((__t=("+i+"))==null?'':_.escape(__t))+\n'":r?s+="'+\n((__t=("+r+"))==null?'':__t)+\n'":a&&(s+="';\n"+a+"\n__p+='"),e}),s+="';\n",e.variable||(s="with(obj||{}){\n"+s+"}\n"),s="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+s+"return __p;\n";try{var a=new Function(e.variable||"obj","_",s)}catch(o){throw o.source=s,o}var l=function(t){return a.call(this,t,y)},h=e.variable||"obj";return l.source="function("+h+"){\n"+s+"}",l},y.chain=function(t){var e=y(t);return e._chain=!0,e};var G=function(t,e){return t._chain?y(e).chain():e};y.mixin=function(t){y.each(y.functions(t),function(e){var i=y[e]=t[e];y.prototype[e]=function(){var t=[this._wrapped];return h.apply(t,arguments),G(this,i.apply(y,t))}})},y.mixin(y),y.each(["pop","push","reverse","shift","sort","splice","unshift"],function(t){var e=a[t];y.prototype[t]=function(){var i=this._wrapped;return e.apply(i,arguments),"shift"!==t&&"splice"!==t||0!==i.length||delete i[0],G(this,i)}}),y.each(["concat","join","slice"],function(t){var e=a[t];y.prototype[t]=function(){return G(this,e.apply(this._wrapped,arguments))}}),y.prototype.value=function(){return this._wrapped},y.prototype.valueOf=y.prototype.toJSON=y.prototype.value,y.prototype.toString=function(){return""+this._wrapped},"function"==typeof define&&define.amd&&define("underscore",[],function(){return y})}).call(this),function(){var t=this,e=t.Backbone||{};t.Backbone=e;var i=[],r=i.slice,n=function(t,e,i){var r,n=-1,s=e.length;switch(i.length){case 0:for(;++n<s;)(r=e[n]).callback.call(r.ctx);return;case 1:for(;++n<s;)(r=e[n]).callback.call(r.ctx,i[0]);return;case 2:for(;++n<s;)(r=e[n]).callback.call(r.ctx,i[0],i[1]);return;case 3:for(;++n<s;)(r=e[n]).callback.call(r.ctx,i[0],i[1],i[2]);return;default:for(;++n<s;)(r=e[n]).callback.apply(r.ctx,i)}},s=e.Events={on:function(t,e,i){this._events||(this._events={});var r=this._events[t]||(this._events[t]=[]);return r.push({callback:e,context:i,ctx:i||this}),this},once:function(t,e,i){var r=this,n=_.once(function(){r.off(t,n),e.apply(this,arguments)});return n._callback=e,this.on(t,n,i),this},off:function(t,e,i){var r,n,s,a,o,l,h,c;if(!this._events)return this;if(!t&&!e&&!i)return this._events={},this;for(a=t?[t]:_.keys(this._events),o=0,l=a.length;o<l;o++)if(t=a[o],r=this._events[t]){if(s=[],e||i)for(h=0,c=r.length;h<c;h++)n=r[h],(e&&e!==(n.callback._callback||n.callback)||i&&i!==n.context)&&s.push(n);this._events[t]=s}return this},trigger:function(t){if(!this._events)return this;var e=r.call(arguments,1),i=this._events[t],s=this._events.all;return i&&n(this,i,e),s&&n(this,s,arguments),this},listenTo:function(t,e,i){var r=this._listeners||(this._listeners={}),n=t._listenerId||(t._listenerId=_.uniqueId("l"));return r[n]=t,t.on(e,i||this,this),this},stopListening:function(t,e,i){var r=this._listeners;if(r){if(t)t.off(e,i,this),e||i||delete r[t._listenerId];else{for(var n in r)r[n].off(null,null,this);this._listeners={}}return this}}};s.bind=s.on,s.unbind=s.off,"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=e),exports.Backbone=e):t.Backbone=e,"function"==typeof define&&define.amd&&define("backbone",[],function(){return e})}(),function(){function t(t,r){var n=(new Date).getTime(),s=Math.max(0,16-(n-i)),a=e.setTimeout(function(){t(n+s)},s);return i=n+s,a}for(var e=this,i=0,r=["ms","moz","webkit","o"],n=0;n<r.length&&!e.requestAnimationFrame;++n)e.requestAnimationFrame=e[r[n]+"RequestAnimationFrame"],e.cancelAnimationFrame=e[r[n]+"CancelAnimationFrame"]||e[r[n]+"CancelRequestAnimationFrame"];e.requestAnimationFrame||(e.requestAnimationFrame=t),e.cancelAnimationFrame||(e.cancelAnimationFrame=function(t){clearTimeout(t)}),"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=e.requestAnimationFrame),exports.requestAnimationFrame=e.requestAnimationFrame):e.requestAnimationFrame=e.requestAnimationFrame,"function"==typeof define&&define.amd&&define("requestAnimationFrame",[],function(){return e.requestAnimationFrame})}(),function(t,e,i,r){function n(){var t=document.body.getBoundingClientRect(),e=this.width=t.width,i=this.height=t.height;this.renderer.setSize(e,i,this.ratio),this.trigger(v.Events.resize,e,i)}function s(){return(a.performance&&a.performance.now?a.performance:Date).now()}var a=this,o=Math.sin,l=Math.cos,h=Math.atan2,c=Math.sqrt,u=(Math.round,Math.abs,Math.PI),f=2*u,d=u/2,p=Math.pow,g=Math.min,_=Math.max,m=0,y={temp:document.createElement("div"),hasEventListeners:e.isFunction(a.addEventListener),bind:function(t,e,i,r){return this.hasEventListeners?t.addEventListener(e,i,!!r):t.attachEvent("on"+e,i),this},unbind:function(t,e,i,r){return this.hasEventListeners?t.removeEventListeners(e,i,!!r):t.detachEvent("on"+e,i),this}},v=a.Two=function(t){var i=e.defaults(t||{},{fullscreen:!1,width:640,height:480,type:v.Types.svg,autostart:!1});if(e.each(i,function(t,e){"fullscreen"!==e&&"width"!==e&&"height"!==e&&"autostart"!==e&&(this[e]=t)},this),e.isElement(i.domElement)){var r=i.domElement.tagName.toLowerCase();/^(CanvasRenderer-canvas|WebGLRenderer-canvas|SVGRenderer-svg)$/.test(this.type+"-"+r)||(this.type=v.Types[r])}if(this.renderer=new v[this.type](this),v.Utils.setPlaying.call(this,i.autostart),this.frameCount=0,i.fullscreen){var s=e.bind(n,this);e.extend(document.body.style,{overflow:"hidden",margin:0,padding:0,top:0,left:0,right:0,bottom:0,position:"fixed"}),e.extend(this.renderer.domElement.style,{display:"block",top:0,left:0,right:0,bottom:0,position:"fixed"}),y.bind(a,"resize",s),s()}else e.isElement(i.domElement)||(this.renderer.setSize(i.width,i.height,this.ratio),this.width=i.width,this.height=i.height);this.scene=this.renderer.scene,v.Instances.push(this)};e.extend(v,{Array:a.Float32Array||Array,Types:{webgl:"WebGLRenderer",svg:"SVGRenderer",canvas:"CanvasRenderer"},Version:"v0.6.0",Identifier:"two_",Properties:{hierarchy:"hierarchy",demotion:"demotion"},Events:{play:"play",pause:"pause",update:"update",render:"render",resize:"resize",change:"change",remove:"remove",insert:"insert",order:"order"},Commands:{move:"M",line:"L",curve:"C",close:"Z"},Resolution:8,Instances:[],noConflict:function(){return a.Two=t,this},uniqueId:function(){var t=m;return m++,t},Utils:{defineProperty:function(t){var e=this,i="_"+t,r="_flag"+t.charAt(0).toUpperCase()+t.slice(1);Object.defineProperty(e,t,{get:function(){return this[i]},set:function(t){this[i]=t,this[r]=!0}})},release:function(t){e.isObject(t)&&(e.isFunction(t.unbind)&&t.unbind(),t.vertices&&(e.isFunction(t.vertices.unbind)&&t.vertices.unbind(),e.each(t.vertices,function(t){e.isFunction(t.unbind)&&t.unbind()})),t.children&&e.each(t.children,function(t){v.Utils.release(t)}))},xhr:function(t,e){var i=new XMLHttpRequest;return i.open("GET",t),i.onreadystatechange=function(){4===i.readyState&&200===i.status&&e(i.responseText)},i.send(),i},Curve:{CollinearityEpsilon:p(10,-30),RecursionLimit:16,CuspLimit:0,Tolerance:{distance:.25,angle:0,epsilon:.01},abscissas:[[.5773502691896257],[0,.7745966692414834],[.33998104358485626,.8611363115940526],[0,.5384693101056831,.906179845938664],[.2386191860831969,.6612093864662645,.932469514203152],[0,.4058451513773972,.7415311855993945,.9491079123427585],[.1834346424956498,.525532409916329,.7966664774136267,.9602898564975363],[0,.3242534234038089,.6133714327005904,.8360311073266358,.9681602395076261],[.14887433898163122,.4333953941292472,.6794095682990244,.8650633666889845,.9739065285171717],[0,.26954315595234496,.5190961292068118,.7301520055740494,.8870625997680953,.978228658146057],[.1252334085114689,.3678314989981802,.5873179542866175,.7699026741943047,.9041172563704749,.9815606342467192],[0,.2304583159551348,.44849275103644687,.6423493394403402,.8015780907333099,.9175983992229779,.9841830547185881],[.10805494870734367,.31911236892788974,.5152486363581541,.6872929048116855,.827201315069765,.9284348836635735,.9862838086968123],[0,.20119409399743451,.3941513470775634,.5709721726085388,.7244177313601701,.8482065834104272,.937273392400706,.9879925180204854],[.09501250983763744,.2816035507792589,.45801677765722737,.6178762444026438,.755404408355003,.8656312023878318,.9445750230732326,.9894009349916499]],weights:[[1],[.8888888888888888,.5555555555555556],[.6521451548625461,.34785484513745385],[.5688888888888889,.47862867049936647,.23692688505618908],[.46791393457269104,.3607615730481386,.17132449237917036],[.4179591836734694,.3818300505051189,.27970539148927664,.1294849661688697],[.362683783378362,.31370664587788727,.22238103445337448,.10122853629037626],[.3302393550012598,.31234707704000286,.26061069640293544,.1806481606948574,.08127438836157441],[.29552422471475287,.26926671930999635,.21908636251598204,.1494513491505806,.06667134430868814],[.2729250867779006,.26280454451024665,.23319376459199048,.18629021092773426,.1255803694649046,.05566856711617366],[.24914704581340277,.2334925365383548,.20316742672306592,.16007832854334622,.10693932599531843,.04717533638651183],[.2325515532308739,.22628318026289723,.2078160475368885,.17814598076194574,.13887351021978725,.09212149983772845,.04048400476531588],[.2152638534631578,.2051984637212956,.18553839747793782,.15720316715819355,.12151857068790319,.08015808715976021,.03511946033175186],[.2025782419255613,.19843148532711158,.1861610000155622,.16626920581699392,.13957067792615432,.10715922046717194,.07036604748810812,.03075324199611727],[.1894506104550685,.18260341504492358,.16915651939500254,.14959598881657674,.12462897125553388,.09515851168249279,.062253523938647894,.027152459411754096]]},devicePixelRatio:a.devicePixelRatio||1,getBackingStoreRatio:function(t){return t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1},getRatio:function(t){return v.Utils.devicePixelRatio/E(t)},setPlaying:function(t){return this.playing=!!t,this},getComputedMatrix:function(t,i){i=i&&i.identity()||new v.Matrix;for(var r=t,n=[];r&&r._matrix;)n.push(r._matrix),r=r.parent;return n.reverse(),e.each(n,function(t){var e=t.elements;i.multiply(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9])}),i},deltaTransformPoint:function(t,e,i){var r=e*t.a+i*t.c+0,n=e*t.b+i*t.d+0;return new v.Vector(r,n)},decomposeMatrix:function(t){var e=v.Utils.deltaTransformPoint(t,0,1),i=v.Utils.deltaTransformPoint(t,1,0),r=180/Math.PI*Math.atan2(e.y,e.x)-90,n=180/Math.PI*Math.atan2(i.y,i.x);return{translateX:t.e,translateY:t.f,scaleX:Math.sqrt(t.a*t.a+t.b*t.b),scaleY:Math.sqrt(t.c*t.c+t.d*t.d),skewX:r,skewY:n,rotation:r}},applySvgAttributes:function(t,i){var r,n,s,a,o={},l={};if(getComputedStyle){var h=getComputedStyle(t);for(r=h.length;r--;)n=h[r],s=h[n],void 0!==s&&(l[n]=s)}for(r=t.attributes.length;r--;)a=t.attributes[r],o[a.nodeName]=a.value;e.isUndefined(l.opacity)||(l["stroke-opacity"]=l.opacity,l["fill-opacity"]=l.opacity),e.extend(l,o),l.visible=!(e.isUndefined(l.display)&&"none"===l.display)||e.isUndefined(l.visibility)&&"hidden"===l.visibility;for(n in l)switch(s=l[n],n){case"transform":if("none"===s)break;var c=t.getCTM();if(null===c)break;var u=v.Utils.decomposeMatrix(t.getCTM());i.translation.set(u.translateX,u.translateY),i.rotation=u.rotation,i.scale=u.scaleX,l.x&&(i.translation.x=l.x),l.y&&(i.translation.y=l.y);break;case"visible":i.visible=s;break;case"stroke-linecap":i.cap=s;break;case"stroke-linejoin":i.join=s;break;case"stroke-miterlimit":i.miter=s;break;case"stroke-width":i.linewidth=parseFloat(s);break;case"stroke-opacity":case"fill-opacity":case"opacity":i.opacity=parseFloat(s);break;case"fill":case"stroke":/url\(\#.*\)/i.test(s)?i[n]=this.getById(s.replace(/url\(\#(.*)\)/i,"$1")):i[n]="none"===s?"transparent":s;break;case"id":i.id=s;break;case"class":i.classList=s.split(" ")}return i},read:{svg:function(){return v.Utils.read.g.apply(this,arguments)},g:function(t){var e=new v.Group;v.Utils.applySvgAttributes.call(this,t,e);for(var i=0,r=t.childNodes.length;i<r;i++){var n=t.childNodes[i],s=n.nodeName;if(!s)return;var a=s.replace(/svg\:/gi,"").toLowerCase();if(a in v.Utils.read){var o=v.Utils.read[a].call(e,n);e.add(o)}}return e},polygon:function(t,e){var i=t.getAttribute("points"),r=[];i.replace(/(-?[\d\.?]+),(-?[\d\.?]+)/g,function(t,e,i){r.push(new v.Anchor(parseFloat(e),parseFloat(i)))});var n=new v.Path(r,(!e)).noStroke();return n.fill="black",v.Utils.applySvgAttributes.call(this,t,n)},polyline:function(t){return v.Utils.read.polygon.call(this,t,!0)},path:function(t){var i,r,n=t.getAttribute("d"),s=new v.Anchor,a=!1,o=!1,l=n.match(/[a-df-z][^a-df-z]*/gi),h=l.length-1;e.each(l.slice(0),function(t,e){var i,r=t[0],n=r.toLowerCase(),s=t.slice(1).trim().split(/[\s,]+|(?=\s?[+\-])/),a=[];switch(e<=0&&(l=[]),n){case"h":case"v":s.length>1&&(i=1);break;case"m":case"l":case"t":s.length>2&&(i=2);break;case"s":case"q":s.length>4&&(i=4);break;case"c":s.length>6&&(i=6);break;case"a":}if(i){for(var o=0,h=s.length,c=0;o<h;o+=i){var u=r;if(c>0)switch(r){case"m":u="l";break;case"M":u="L"}a.push([u].concat(s.slice(o,o+i)).join(" ")),c++}l=Array.prototype.concat.apply(l,a)}else l.push(t)});var c=e.flatten(e.map(l,function(t,n){var l,c,u,f=t[0],d=f.toLowerCase();r=t.slice(1).trim(),r=r.replace(/(-?\d+(?:\.\d*)?)[eE]([+\-]?\d+)/g,function(t,e,i){return parseFloat(e)*p(10,i)}),r=r.split(/[\s,]+|(?=\s?[+\-])/),o=f===d;var g,_,m,y,b,x,A,w,E;switch(d){case"z":n>=h?a=!0:(c=s.x,u=s.y,l=new v.Anchor(c,u,(void 0),(void 0),(void 0),(void 0),v.Commands.close));break;case"m":case"l":c=parseFloat(r[0]),u=parseFloat(r[1]),l=new v.Anchor(c,u,(void 0),(void 0),(void 0),(void 0),"m"===d?v.Commands.move:v.Commands.line),o&&l.addSelf(s),s=l;break;case"h":case"v":var S="h"===d?"x":"y",C="x"===S?"y":"x";l=new v.Anchor((void 0),(void 0),(void 0),(void 0),(void 0),(void 0),v.Commands.line),l[S]=parseFloat(r[0]),l[C]=s[C],o&&(l[S]+=s[S]),s=l;break;case"c":case"s":g=s.x,_=s.y,i||(i=new v.Vector),"c"===d?(m=parseFloat(r[0]),y=parseFloat(r[1]),b=parseFloat(r[2]),x=parseFloat(r[3]),A=parseFloat(r[4]),w=parseFloat(r[5])):(E=M(s,i,o),m=E.x,y=E.y,b=parseFloat(r[0]),x=parseFloat(r[1]),A=parseFloat(r[2]),w=parseFloat(r[3])),o&&(m+=g,y+=_,b+=g,x+=_,A+=g,w+=_),e.isObject(s.controls)||v.Anchor.AppendCurveProperties(s),s.controls.right.set(m-s.x,y-s.y),l=new v.Anchor(A,w,b-A,x-w,(void 0),(void 0),v.Commands.curve),s=l,i=l.controls.left;break;case"t":case"q":g=s.x,_=s.y,i||(i=new v.Vector),i.isZero()?(m=g,y=_):(m=i.x,_=i.y),"q"===d?(b=parseFloat(r[0]),x=parseFloat(r[1]),A=parseFloat(r[1]),w=parseFloat(r[2])):(E=M(s,i,o),b=E.x,x=E.y,A=parseFloat(r[0]),w=parseFloat(r[1])),o&&(m+=g,y+=_,b+=g,x+=_,A+=g,w+=_),e.isObject(s.controls)||v.Anchor.AppendCurveProperties(s),s.controls.right.set(m-s.x,y-s.y),l=new v.Anchor(A,w,b-A,x-w,(void 0),(void 0),v.Commands.curve),s=l,i=l.controls.left;break;case"a":g=s.x,_=s.y;var F=parseFloat(r[0]),q=parseFloat(r[1]),P=parseFloat(r[2])*Math.PI/180,O=parseFloat(r[3]),R=parseFloat(r[4]);A=parseFloat(r[5]),w=parseFloat(r[6]),o&&(A+=g,w+=_);var T=(A-g)/2,U=(w-_)/2,j=T*Math.cos(P)+U*Math.sin(P),B=-T*Math.sin(P)+U*Math.cos(P),L=F*F,N=q*q,I=j*j,G=B*B,V=I/L+G/N;V>1&&(F*=Math.sqrt(V),q*=Math.sqrt(V));var z=Math.sqrt((L*N-L*G-N*I)/(L*G+N*I));e.isNaN(z)?z=0:O!=R&&z>0&&(z*=-1);var D=z*F*B/q,H=-z*q*j/F,X=D*Math.cos(P)-H*Math.sin(P)+(g+A)/2,K=D*Math.sin(P)+H*Math.cos(P)+(_+w)/2,Y=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2))},W=function(t,e){return(t[0]*e[0]+t[1]*e[1])/(Y(t)*Y(e))},S=function(t,e){return(t[0]*e[1]<t[1]*e[0]?-1:1)*Math.acos(W(t,e))},J=S([1,0],[(j-D)/F,(B-H)/q]),Z=[(j-D)/F,(B-H)/q],$=[(-j-D)/F,(-B-H)/q],Q=S(Z,$);W(Z,$)<=-1&&(Q=Math.PI),W(Z,$)>=1&&(Q=0),O&&(Q=k(Q,2*Math.PI)),R&&Q>0&&(Q-=2*Math.PI);var tt=v.Resolution,et=(new v.Matrix).translate(X,K).rotate(P);l=e.map(e.range(tt),function(t){var e=1-t/(tt-1),i=e*Q+J,r=F*Math.cos(i),n=q*Math.sin(i),s=et.multiply(r,n,1);return new v.Anchor(s.x,s.y,(!1),(!1),(!1),(!1),v.Commands.line)}),l.push(new v.Anchor(A,w,(!1),(!1),(!1),(!1),v.Commands.line)),s=l[l.length-1],i=s.controls.left}return l}));if(!(c.length<=1)){c=e.compact(c);var u=new v.Path(c,a,(void 0),(!0)).noStroke();return u.fill="black",v.Utils.applySvgAttributes.call(this,t,u)}},circle:function(t){var i=parseFloat(t.getAttribute("cx")),r=parseFloat(t.getAttribute("cy")),n=parseFloat(t.getAttribute("r")),s=v.Resolution,a=e.map(e.range(s),function(t){var e=t/s,i=e*f,r=n*l(i),a=n*o(i);return new v.Anchor(r,a)}),h=new v.Path(a,(!0),(!0)).noStroke();return h.translation.set(i,r),h.fill="black",v.Utils.applySvgAttributes.call(this,t,h)},ellipse:function(t){var i=parseFloat(t.getAttribute("cx")),r=parseFloat(t.getAttribute("cy")),n=parseFloat(t.getAttribute("rx")),s=parseFloat(t.getAttribute("ry")),a=v.Resolution,h=e.map(e.range(a),function(t){var e=t/a,i=e*f,r=n*l(i),h=s*o(i);return new v.Anchor(r,h)}),c=new v.Path(h,(!0),(!0)).noStroke();return c.translation.set(i,r),c.fill="black",v.Utils.applySvgAttributes.call(this,t,c)},rect:function(t){var e=parseFloat(t.getAttribute("x"))||0,i=parseFloat(t.getAttribute("y"))||0,r=parseFloat(t.getAttribute("width")),n=parseFloat(t.getAttribute("height")),s=r/2,a=n/2,o=[new v.Anchor(s,a),new v.Anchor((-s),a),new v.Anchor((-s),(-a)),new v.Anchor(s,(-a))],l=new v.Path(o,(!0)).noStroke();return l.translation.set(e+s,i+a),
l.fill="black",v.Utils.applySvgAttributes.call(this,t,l)},line:function(t){var e=parseFloat(t.getAttribute("x1")),i=parseFloat(t.getAttribute("y1")),r=parseFloat(t.getAttribute("x2")),n=parseFloat(t.getAttribute("y2")),s=r-e,a=n-i,o=s/2,l=a/2,h=[new v.Anchor((-o),(-l)),new v.Anchor(o,l)],c=new v.Path(h).noFill();return c.translation.set(e+o,i+l),v.Utils.applySvgAttributes.call(this,t,c)},lineargradient:function(t){for(var i=parseFloat(t.getAttribute("x1")),r=parseFloat(t.getAttribute("y1")),n=parseFloat(t.getAttribute("x2")),s=parseFloat(t.getAttribute("y2")),a=(n+i)/2,o=(s+r)/2,l=[],h=0;h<t.children.length;h++){var c=t.children[h],u=parseFloat(c.getAttribute("offset")),f=c.getAttribute("stop-color"),d=c.getAttribute("stop-opacity"),p=c.getAttribute("style");if(e.isNull(f)){var g=p.match(/stop\-color\:\s?([\#a-fA-F0-9]*)/);f=g&&g.length>1?g[1]:void 0}if(e.isNull(d)){var g=p.match(/stop\-opacity\:\s?([0-1\.\-]*)/);d=g&&g.length>1?parseFloat(g[1]):1}l.push(new v.Gradient.Stop(u,f,d))}var _=new v.LinearGradient(i-a,r-o,n-a,s-o,l);return v.Utils.applySvgAttributes.call(this,t,_)},radialgradient:function(t){var i=parseFloat(t.getAttribute("cx"))||0,r=parseFloat(t.getAttribute("cy"))||0,n=parseFloat(t.getAttribute("r")),s=parseFloat(t.getAttribute("fx")),a=parseFloat(t.getAttribute("fy"));e.isNaN(s)&&(s=i),e.isNaN(a)&&(a=r);for(var o=Math.abs(i+s)/2,l=Math.abs(r+a)/2,h=[],c=0;c<t.children.length;c++){var u=t.children[c],f=parseFloat(u.getAttribute("offset")),d=u.getAttribute("stop-color"),p=u.getAttribute("stop-opacity"),g=u.getAttribute("style");if(e.isNull(d)){var _=g.match(/stop\-color\:\s?([\#a-fA-F0-9]*)/);d=_&&_.length>1?_[1]:void 0}if(e.isNull(p)){var _=g.match(/stop\-opacity\:\s?([0-1\.\-]*)/);p=_&&_.length>1?parseFloat(_[1]):1}h.push(new v.Gradient.Stop(f,d,p))}var m=new v.RadialGradient(i-o,r-l,n,h,s-o,a-l);return v.Utils.applySvgAttributes.call(this,t,m)}},subdivide:function(t,i,r,n,s,a,o,l,h){h=h||v.Utils.Curve.RecursionLimit;var c=h+1;return t===o&&i===l?[new v.Anchor(o,l)]:e.map(e.range(0,c),function(e){var h=e/c,u=S(h,t,r,s,o),f=S(h,i,n,a,l);return new v.Anchor(u,f)})},getPointOnCubicBezier:function(t,e,i,r,n){var s=1-t;return s*s*s*e+3*s*s*t*i+3*s*t*t*r+t*t*t*n},getCurveLength:function(t,e,i,r,n,s,a,o,l){if(t===i&&e===r&&n===a&&s===o){var h=a-t,u=o-e;return c(h*h+u*u)}var f=9*(i-n)+3*(a-t),d=6*(t+n)-12*i,p=3*(i-t),g=9*(r-s)+3*(o-e),_=6*(e+s)-12*r,m=3*(r-e),y=function(t){var e=(f*t+d)*t+p,i=(g*t+_)*t+m;return c(e*e+i*i)};return C(y,0,1,l||v.Utils.Curve.RecursionLimit)},integrate:function(t,e,i,r){for(var n=v.Utils.Curve.abscissas[r-2],s=v.Utils.Curve.weights[r-2],a=.5*(i-e),o=a+e,l=0,h=r+1>>1,c=1&r?s[l++]*t(o):0;l<h;){var u=a*n[l];c+=s[l++]*(t(o+u)+t(o-u))}return a*c},getCurveFromPoints:function(t,i){for(var r=t.length,n=r-1,s=0;s<r;s++){var a=t[s];e.isObject(a.controls)||v.Anchor.AppendCurveProperties(a);var o=i?k(s-1,r):_(s-1,0),l=i?k(s+1,r):g(s+1,n),h=t[o],c=a,u=t[l];w(h,c,u),c._command=0===s?v.Commands.move:v.Commands.curve,c.controls.left.x=e.isNumber(c.controls.left.x)?c.controls.left.x:c.x,c.controls.left.y=e.isNumber(c.controls.left.y)?c.controls.left.y:c.y,c.controls.right.x=e.isNumber(c.controls.right.x)?c.controls.right.x:c.x,c.controls.right.y=e.isNumber(c.controls.right.y)?c.controls.right.y:c.y}},getControlPoints:function(t,i,r){var n=A(t,i),s=A(r,i),a=b(t,i),h=b(r,i),c=(n+s)/2;return i.u=e.isObject(i.controls.left)?i.controls.left:new v.Vector(0,0),i.v=e.isObject(i.controls.right)?i.controls.right:new v.Vector(0,0),a<1e-4||h<1e-4?(i._relative||(i.controls.left.copy(i),i.controls.right.copy(i)),i):(a*=.33,h*=.33,s<n?c+=d:c-=d,i.controls.left.x=l(c)*a,i.controls.left.y=o(c)*a,c-=u,i.controls.right.x=l(c)*h,i.controls.right.y=o(c)*h,i._relative||(i.controls.left.x+=i.x,i.controls.left.y+=i.y,i.controls.right.x+=i.x,i.controls.right.y+=i.y),i)},getReflection:function(t,e,i){return new v.Vector(2*t.x-(e.x+t.x)-(i?t.x:0),2*t.y-(e.y+t.y)-(i?t.y:0))},getAnchorsFromArcData:function(t,i,r,n,s,a,o){var l=((new v.Matrix).translate(t.x,t.y).rotate(i),v.Resolution);return e.map(e.range(l),function(t){var e=(t+1)/l;o&&(e=1-e);var i=e*a+s,h=r*Math.cos(i),c=n*Math.sin(i),u=new v.Anchor(h,c);return v.Anchor.AppendCurveProperties(u),u.command=v.Commands.line,u})},ratioBetween:function(t,e){return(t.x*e.x+t.y*e.y)/(t.length()*e.length())},angleBetween:function(t,e){var i,r;return arguments.length>=4?(i=arguments[0]-arguments[2],r=arguments[1]-arguments[3],h(r,i)):(i=t.x-e.x,r=t.y-e.y,h(r,i))},distanceBetweenSquared:function(t,e){var i=t.x-e.x,r=t.y-e.y;return i*i+r*r},distanceBetween:function(t,e){return c(x(t,e))},toFixed:function(t){return Math.floor(1e3*t)/1e3},mod:function(t,e){for(;t<0;)t+=e;return t%e},Collection:function(){Array.call(this),arguments.length>1?Array.prototype.push.apply(this,arguments):arguments[0]&&Array.isArray(arguments[0])&&Array.prototype.push.apply(this,arguments[0])},Error:function(t){this.name="two.js",this.message=t}}}),v.Utils.Error.prototype=new Error,v.Utils.Error.prototype.constructor=v.Utils.Error,v.Utils.Collection.prototype=new Array,v.Utils.Collection.constructor=v.Utils.Collection,e.extend(v.Utils.Collection.prototype,i.Events,{pop:function(){var t=Array.prototype.pop.apply(this,arguments);return this.trigger(v.Events.remove,[t]),t},shift:function(){var t=Array.prototype.shift.apply(this,arguments);return this.trigger(v.Events.remove,[t]),t},push:function(){var t=Array.prototype.push.apply(this,arguments);return this.trigger(v.Events.insert,arguments),t},unshift:function(){var t=Array.prototype.unshift.apply(this,arguments);return this.trigger(v.Events.insert,arguments),t},splice:function(){var t,e=Array.prototype.splice.apply(this,arguments);return this.trigger(v.Events.remove,e),arguments.length>2&&(t=this.slice(arguments[0],arguments.length-2),this.trigger(v.Events.insert,t),this.trigger(v.Events.order)),e},sort:function(){return Array.prototype.sort.apply(this,arguments),this.trigger(v.Events.order),this},reverse:function(){return Array.prototype.reverse.apply(this,arguments),this.trigger(v.Events.order),this}});var b=v.Utils.distanceBetween,x=(v.Utils.getAnchorsFromArcData,v.Utils.distanceBetweenSquared),A=(v.Utils.ratioBetween,v.Utils.angleBetween),w=v.Utils.getControlPoints,k=(v.Utils.getCurveFromPoints,v.Utils.solveSegmentIntersection,v.Utils.decoupleShapes,v.Utils.mod),E=v.Utils.getBackingStoreRatio,S=v.Utils.getPointOnCubicBezier,C=(v.Utils.getCurveLength,v.Utils.integrate),M=v.Utils.getReflection;e.extend(v.prototype,i.Events,{appendTo:function(t){return t.appendChild(this.renderer.domElement),this},play:function(){return v.Utils.setPlaying.call(this,!0),this.trigger(v.Events.play)},pause:function(){return this.playing=!1,this.trigger(v.Events.pause)},update:function(){var t=!!this._lastFrame,e=s();this.frameCount++,t&&(this.timeDelta=parseFloat((e-this._lastFrame).toFixed(3))),this._lastFrame=e;var i=this.width,r=this.height,n=this.renderer;return i===n.width&&r===n.height||n.setSize(i,r,this.ratio),this.trigger(v.Events.update,this.frameCount,this.timeDelta),this.render()},render:function(){return this.renderer.render(),this.trigger(v.Events.render,this.frameCount)},add:function(t){var i=t;return i instanceof Array||(i=e.toArray(arguments)),this.scene.add(i),this},remove:function(t){var i=t;return i instanceof Array||(i=e.toArray(arguments)),this.scene.remove(i),this},clear:function(){return this.scene.remove(e.toArray(this.scene.children)),this},makeLine:function(t,e,i,r){var n=new v.Line(t,e,i,r);return this.scene.add(n),n},makeRectangle:function(t,e,i,r){var n=new v.Rectangle(t,e,i,r);return this.scene.add(n),n},makeRoundedRectangle:function(t,e,i,r,n){var s=new v.RoundedRectangle(t,e,i,r,n);return this.scene.add(s),s},makeCircle:function(t,e,i){return this.makeEllipse(t,e,i,i)},makeEllipse:function(t,e,i,r){var n=new v.Ellipse(t,e,i,r);return this.scene.add(n),n},makeStar:function(t,e,i,r,n){var s=new v.Star(t,e,i,r,n);return this.scene.add(s),s},makeCurve:function(t){var i=arguments.length,r=t;if(!e.isArray(t)){r=[];for(var n=0;n<i;n+=2){var s=arguments[n];if(!e.isNumber(s))break;var a=arguments[n+1];r.push(new v.Anchor(s,a))}}var o=arguments[i-1],l=new v.Path(r,(!(e.isBoolean(o)?o:void 0)),(!0)),h=l.getBoundingClientRect();return l.center().translation.set(h.left+h.width/2,h.top+h.height/2),this.scene.add(l),l},makePolygon:function(t,e,i,r){var n=new v.Polygon(t,e,i,r);return this.scene.add(n),n},makeArcSegment:function(t,e,i,r,n,s,a){var o=new v.ArcSegment(t,e,i,r,n,s,a);return this.scene.add(o),o},makePath:function(t){var i=arguments.length,r=t;if(!e.isArray(t)){r=[];for(var n=0;n<i;n+=2){var s=arguments[n];if(!e.isNumber(s))break;var a=arguments[n+1];r.push(new v.Anchor(s,a))}}var o=arguments[i-1],l=new v.Path(r,(!(e.isBoolean(o)?o:void 0))),h=l.getBoundingClientRect();return l.center().translation.set(h.left+h.width/2,h.top+h.height/2),this.scene.add(l),l},makeText:function(t,e,i,r){var n=new v.Text(t,e,i,r);return this.add(n),n},makeLinearGradient:function(t,e,i,r){var n=Array.prototype.slice.call(arguments,4),s=new v.LinearGradient(t,e,i,r,n);return this.add(s),s},makeRadialGradient:function(t,e,i){var r=Array.prototype.slice.call(arguments,3),n=new v.RadialGradient(t,e,i,r);return this.add(n),n},makeGroup:function(t){var i=t;i instanceof Array||(i=e.toArray(arguments));var r=new v.Group;return this.scene.add(r),r.add(i),r},interpret:function(t,e){var i=t.tagName.toLowerCase();if(!(i in v.Utils.read))return null;var r=v.Utils.read[i].call(this,t);return e&&r instanceof v.Group?this.add(r.children):this.add(r),r},load:function(t,i){var r,n,s=[];if(/.*\.svg/gi.test(t))return v.Utils.xhr(t,e.bind(function(t){for(y.temp.innerHTML=t,n=0;n<y.temp.children.length;n++)r=y.temp.children[n],s.push(this.interpret(r));i(s.length<=1?s[0]:s,y.temp.children.length<=1?y.temp.children[0]:y.temp.children)},this)),this;for(y.temp.innerHTML=t,n=0;n<y.temp.children.length;n++)r=y.temp.children[n],s.push(this.interpret(r));return i(s.length<=1?s[0]:s,y.temp.children.length<=1?y.temp.children[0]:y.temp.children),this}}),function(){r(arguments.callee),v.Instances.forEach(function(t){t.playing&&t.update()})}(),"function"==typeof define&&define.amd?define(function(){return v}):"undefined"!=typeof module&&module.exports&&(module.exports=v)}(this.Two,"function"!=typeof require||"function"==typeof define&&define.amd?this._:require("underscore"),"function"!=typeof require||"function"==typeof define&&define.amd?this.Backbone:require("backbone"),"function"!=typeof require||"function"==typeof define&&define.amd?this.requestAnimationFrame:require("requestAnimationFrame")),function(t,e,i,r){var n=t.Vector=function(t,e){this.x=t||0,this.y=e||0};e.extend(n,{zero:new t.Vector}),e.extend(n.prototype,i.Events,{set:function(t,e){return this.x=t,this.y=e,this},copy:function(t){return this.x=t.x,this.y=t.y,this},clear:function(){return this.x=0,this.y=0,this},clone:function(){return new n(this.x,this.y)},add:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this},addSelf:function(t){return this.x+=t.x,this.y+=t.y,this},sub:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this},subSelf:function(t){return this.x-=t.x,this.y-=t.y,this},multiplySelf:function(t){return this.x*=t.x,this.y*=t.y,this},multiplyScalar:function(t){return this.x*=t,this.y*=t,this},divideScalar:function(t){return t?(this.x/=t,this.y/=t):this.set(0,0),this},negate:function(){return this.multiplyScalar(-1)},dot:function(t){return this.x*t.x+this.y*t.y},lengthSquared:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.lengthSquared())},normalize:function(){return this.divideScalar(this.length())},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){var e=this.x-t.x,i=this.y-t.y;return e*e+i*i},setLength:function(t){return this.normalize().multiplyScalar(t)},equals:function(t,e){return e="undefined"==typeof e?1e-4:e,this.distanceTo(t)<e},lerp:function(t,e){var i=(t.x-this.x)*e+this.x,r=(t.y-this.y)*e+this.y;return this.set(i,r)},isZero:function(t){return t="undefined"==typeof t?1e-4:t,this.length()<t},toString:function(){return this.x+","+this.y},toObject:function(){return{x:this.x,y:this.y}}});var s={set:function(e,i){return this._x=e,this._y=i,this.trigger(t.Events.change)},copy:function(e){return this._x=e.x,this._y=e.y,this.trigger(t.Events.change)},clear:function(){return this._x=0,this._y=0,this.trigger(t.Events.change)},clone:function(){return new n(this._x,this._y)},add:function(e,i){return this._x=e.x+i.x,this._y=e.y+i.y,this.trigger(t.Events.change)},addSelf:function(e){return this._x+=e.x,this._y+=e.y,this.trigger(t.Events.change)},sub:function(e,i){return this._x=e.x-i.x,this._y=e.y-i.y,this.trigger(t.Events.change)},subSelf:function(e){return this._x-=e.x,this._y-=e.y,this.trigger(t.Events.change)},multiplySelf:function(e){return this._x*=e.x,this._y*=e.y,this.trigger(t.Events.change)},multiplyScalar:function(e){return this._x*=e,this._y*=e,this.trigger(t.Events.change)},divideScalar:function(e){return e?(this._x/=e,this._y/=e,this.trigger(t.Events.change)):this.clear()},negate:function(){return this.multiplyScalar(-1)},dot:function(t){return this._x*t.x+this._y*t.y},lengthSquared:function(){return this._x*this._x+this._y*this._y},length:function(){return Math.sqrt(this.lengthSquared())},normalize:function(){return this.divideScalar(this.length())},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){var e=this._x-t.x,i=this._y-t.y;return e*e+i*i},setLength:function(t){return this.normalize().multiplyScalar(t)},equals:function(t,e){return e="undefined"==typeof e?1e-4:e,this.distanceTo(t)<e},lerp:function(t,e){var i=(t.x-this._x)*e+this._x,r=(t.y-this._y)*e+this._y;return this.set(i,r)},isZero:function(t){return t="undefined"==typeof t?1e-4:t,this.length()<t},toString:function(){return this._x+","+this._y},toObject:function(){return{x:this._x,y:this._y}}},a={get:function(){return this._x},set:function(e){this._x=e,this.trigger(t.Events.change,"x")}},o={get:function(){return this._y},set:function(e){this._y=e,this.trigger(t.Events.change,"y")}};t.Vector.prototype.bind=t.Vector.prototype.on=function(){return this._bound||(this._x=this.x,this._y=this.y,Object.defineProperty(this,"x",a),Object.defineProperty(this,"y",o),e.extend(this,s),this._bound=!0),i.Events.bind.apply(this,arguments),this}}(this.Two,"function"!=typeof require||"function"==typeof define&&define.amd?this._:require("underscore"),"function"!=typeof require||"function"==typeof define&&define.amd?this.Backbone:require("backbone"),"function"!=typeof require||"function"==typeof define&&define.amd?this.requestAnimationFrame:require("requestAnimationFrame")),function(t,e,i,r){var n=t.Commands,s=t.Anchor=function(i,r,a,o,l,h,c){return t.Vector.call(this,i,r),this._broadcast=e.bind(function(){this.trigger(t.Events.change)},this),this._command=c||n.move,this._relative=!0,c?(s.AppendCurveProperties(this),e.isNumber(a)&&(this.controls.left.x=a),e.isNumber(o)&&(this.controls.left.y=o),e.isNumber(l)&&(this.controls.right.x=l),void(e.isNumber(h)&&(this.controls.right.y=h))):this};e.extend(s,{AppendCurveProperties:function(e){e.controls={left:new t.Vector(0,0),right:new t.Vector(0,0)}}});var a={listen:function(){return e.isObject(this.controls)||s.AppendCurveProperties(this),this.controls.left.bind(t.Events.change,this._broadcast),this.controls.right.bind(t.Events.change,this._broadcast),this},ignore:function(){return this.controls.left.unbind(t.Events.change,this._broadcast),this.controls.right.unbind(t.Events.change,this._broadcast),this},clone:function(){var e=this.controls,i=new t.Anchor(this.x,this.y,e&&e.left.x,e&&e.left.y,e&&e.right.x,e&&e.right.y,this.command);return i.relative=this._relative,i},toObject:function(){var t={x:this.x,y:this.y};return this._command&&(t.command=this._command),this._relative&&(t.relative=this._relative),this.controls&&(t.controls={left:this.controls.left.toObject(),right:this.controls.right.toObject()}),t}};Object.defineProperty(s.prototype,"command",{get:function(){return this._command},set:function(i){return this._command=i,this._command!==n.curve||e.isObject(this.controls)||s.AppendCurveProperties(this),this.trigger(t.Events.change)}}),Object.defineProperty(s.prototype,"relative",{get:function(){return this._relative},set:function(e){return this._relative==e?this:(this._relative=!!e,this.trigger(t.Events.change))}}),e.extend(s.prototype,t.Vector.prototype,a),t.Anchor.prototype.bind=t.Anchor.prototype.on=function(){t.Vector.prototype.bind.apply(this,arguments),e.extend(this,a)},t.Anchor.prototype.unbind=t.Anchor.prototype.off=function(){t.Vector.prototype.unbind.apply(this,arguments),e.extend(this,a)}}(this.Two,"function"!=typeof require||"function"==typeof define&&define.amd?this._:require("underscore"),"function"!=typeof require||"function"==typeof define&&define.amd?this.Backbone:require("backbone"),"function"!=typeof require||"function"==typeof define&&define.amd?this.requestAnimationFrame:require("requestAnimationFrame")),function(t,e,i,r){var n=Math.cos,s=Math.sin,a=Math.tan,o=t.Matrix=function(i,r,n,s,a,o){this.elements=new t.Array(9);var l=i;e.isArray(l)||(l=e.toArray(arguments)),this.identity().set(l)};e.extend(o,{Identity:[1,0,0,0,1,0,0,0,1],Multiply:function(e,i,r){if(i.length<=3){var n,s,a,o=e,l=i[0]||0,h=i[1]||0,c=i[2]||0;return n=o[0]*l+o[1]*h+o[2]*c,s=o[3]*l+o[4]*h+o[5]*c,a=o[6]*l+o[7]*h+o[8]*c,{x:n,y:s,z:a}}var u=e[0],f=e[1],d=e[2],p=e[3],g=e[4],_=e[5],m=e[6],y=e[7],v=e[8],b=i[0],x=i[1],A=i[2],w=i[3],k=i[4],E=i[5],S=i[6],C=i[7],M=i[8];return r=r||new t.Array(9),r[0]=u*b+f*w+d*S,r[1]=u*x+f*k+d*C,r[2]=u*A+f*E+d*M,r[3]=p*b+g*w+_*S,r[4]=p*x+g*k+_*C,r[5]=p*A+g*E+_*M,r[6]=m*b+y*w+v*S,r[7]=m*x+y*k+v*C,r[8]=m*A+y*E+v*M,r}}),e.extend(o.prototype,i.Events,{set:function(i){var r=i;return e.isArray(r)||(r=e.toArray(arguments)),e.extend(this.elements,r),this.trigger(t.Events.change)},identity:function(){return this.set(o.Identity),this},multiply:function(i,r,n,s,a,o,l,h,c){var u=arguments,f=u.length;if(f<=1)return e.each(this.elements,function(t,e){this.elements[e]=t*i},this),this.trigger(t.Events.change);if(f<=3){var d,p,g;return i=i||0,r=r||0,n=n||0,a=this.elements,d=a[0]*i+a[1]*r+a[2]*n,p=a[3]*i+a[4]*r+a[5]*n,g=a[6]*i+a[7]*r+a[8]*n,{x:d,y:p,z:g}}var _=this.elements,m=u,y=_[0],v=_[1],b=_[2],x=_[3],A=_[4],w=_[5],k=_[6],E=_[7],S=_[8],C=m[0],M=m[1],F=m[2],q=m[3],P=m[4],O=m[5],R=m[6],T=m[7],U=m[8];return this.elements[0]=y*C+v*q+b*R,this.elements[1]=y*M+v*P+b*T,this.elements[2]=y*F+v*O+b*U,this.elements[3]=x*C+A*q+w*R,this.elements[4]=x*M+A*P+w*T,this.elements[5]=x*F+A*O+w*U,this.elements[6]=k*C+E*q+S*R,this.elements[7]=k*M+E*P+S*T,this.elements[8]=k*F+E*O+S*U,this.trigger(t.Events.change)},inverse:function(e){var i=this.elements;e=e||new t.Matrix;var r=i[0],n=i[1],s=i[2],a=i[3],o=i[4],l=i[5],h=i[6],c=i[7],u=i[8],f=u*o-l*c,d=-u*a+l*h,p=c*a-o*h,g=r*f+n*d+s*p;return g?(g=1/g,e.elements[0]=f*g,e.elements[1]=(-u*n+s*c)*g,e.elements[2]=(l*n-s*o)*g,e.elements[3]=d*g,e.elements[4]=(u*r-s*h)*g,e.elements[5]=(-l*r+s*a)*g,e.elements[6]=p*g,e.elements[7]=(-c*r+n*h)*g,e.elements[8]=(o*r-n*a)*g,e):null},scale:function(t,e){var i=arguments.length;return i<=1&&(e=t),this.multiply(t,0,0,0,e,0,0,0,1)},rotate:function(t){var e=n(t),i=s(t);return this.multiply(e,-i,0,i,e,0,0,0,1)},translate:function(t,e){return this.multiply(1,0,t,0,1,e,0,0,1)},skewX:function(t){var e=a(t);return this.multiply(1,e,0,0,1,0,0,0,1)},skewY:function(t){var e=a(t);return this.multiply(1,0,0,e,1,0,0,0,1)},toString:function(t){var e=[];return this.toArray(t,e),e.join(" ")},toArray:function(t,e){var i=this.elements,r=!!e,n=parseFloat(i[0].toFixed(3)),s=parseFloat(i[1].toFixed(3)),a=parseFloat(i[2].toFixed(3)),o=parseFloat(i[3].toFixed(3)),l=parseFloat(i[4].toFixed(3)),h=parseFloat(i[5].toFixed(3));if(t){var c=parseFloat(i[6].toFixed(3)),u=parseFloat(i[7].toFixed(3)),f=parseFloat(i[8].toFixed(3));return r?(e[0]=n,e[1]=o,e[2]=c,e[3]=s,e[4]=l,e[5]=u,e[6]=a,e[7]=h,void(e[8]=f)):[n,o,c,s,l,u,a,h,f]}return r?(e[0]=n,e[1]=o,e[2]=s,e[3]=l,e[4]=a,void(e[5]=h)):[n,o,s,l,a,h]},clone:function(){var e,i,r,n,s,a,o,l,h;return e=this.elements[0],i=this.elements[1],r=this.elements[2],n=this.elements[3],s=this.elements[4],a=this.elements[5],o=this.elements[6],l=this.elements[7],h=this.elements[8],new t.Matrix(e,i,r,n,s,a,o,l,h)}})}(this.Two,"function"!=typeof require||"function"==typeof define&&define.amd?this._:require("underscore"),"function"!=typeof require||"function"==typeof define&&define.amd?this.Backbone:require("backbone"),"function"!=typeof require||"function"==typeof define&&define.amd?this.requestAnimationFrame:require("requestAnimationFrame")),function(t,e,i,r){var n=t.Utils.mod,s=t.Utils.toFixed,a={version:1.1,ns:"http://www.w3.org/2000/svg",xlink:"http://www.w3.org/1999/xlink",alignments:{left:"start",center:"middle",right:"end"},createElement:function(t,i){var r=t,n=document.createElementNS(this.ns,r);return"svg"===r&&(i=e.defaults(i||{},{version:this.version})),e.isEmpty(i)||a.setAttributes(n,i),n},setAttributes:function(t,e){for(var i=Object.keys(e),r=0;r<i.length;r++)t.setAttribute(i[r],e[i[r]]);return this},removeAttributes:function(t,e){for(var i in e)t.removeAttribute(i);return this},toString:function(e,i){for(var r,a=e.length,o=a-1,l="",h=0;h<a;h++){var c,u,f,d,p,g,_,m,y,v=e[h],b=i?n(h-1,a):Math.max(h-1,0),x=i?n(h+1,a):Math.min(h+1,o),A=e[b],w=e[x],k=s(v._x),E=s(v._y);switch(v._command){case t.Commands.close:c=t.Commands.close;break;case t.Commands.curve:g=A.controls&&A.controls.right||A,_=v.controls&&v.controls.left||v,A._relative?(u=s(g.x+A.x),f=s(g.y+A.y)):(u=s(g.x),f=s(g.y)),v._relative?(d=s(_.x+v.x),p=s(_.y+v.y)):(d=s(_.x),p=s(_.y)),c=(0===h?t.Commands.move:t.Commands.curve)+" "+u+" "+f+" "+d+" "+p+" "+k+" "+E;break;case t.Commands.move:r=v,c=t.Commands.move+" "+k+" "+E;break;default:c=v._command+" "+k+" "+E}h>=o&&i&&(v._command===t.Commands.curve&&(w=r,m=v.controls&&v.controls.right||v,y=w.controls&&w.controls.left||w,v._relative?(u=s(m.x+v.x),f=s(m.y+v.y)):(u=s(m.x),f=s(m.y)),w._relative?(d=s(y.x+w.x),p=s(y.y+w.y)):(d=s(y.x),p=s(y.y)),k=s(w.x),E=s(w.y),c+=" C "+u+" "+f+" "+d+" "+p+" "+k+" "+E),c+=" Z"),l+=c+" "}return l},getClip:function(t){var e=t._renderer.clip;if(!e){for(var i=t;i.parent;)i=i.parent;e=t._renderer.clip=a.createElement("clipPath"),i.defs.appendChild(e)}return e},group:{appendChild:function(t){var e=t._renderer.elem;if(e){var i=e.nodeName;!i||/(radial|linear)gradient/i.test(i)||t._clip||this.elem.appendChild(e)}},removeChild:function(t){var e=t._renderer.elem;if(e&&e.parentNode==this.elem){var i=e.nodeName;i&&(t._clip||this.elem.removeChild(e))}},orderChild:function(t){this.elem.appendChild(t._renderer.elem)},renderChild:function(t){a[t._renderer.type].render.call(t,this)},render:function(t){if(this._update(),0===this._opacity&&!this._flagOpacity)return this;this._renderer.elem||(this._renderer.elem=a.createElement("g",{id:this.id}),t.appendChild(this._renderer.elem));var e=this._matrix.manual||this._flagMatrix,i={domElement:t,elem:this._renderer.elem};e&&this._renderer.elem.setAttribute("transform","matrix("+this._matrix.toString()+")");for(var r=0;r<this.children.length;r++){var n=this.children[r];a[n._renderer.type].render.call(n,t)}return this._flagOpacity&&this._renderer.elem.setAttribute("opacity",this._opacity),this._flagAdditions&&this.additions.forEach(a.group.appendChild,i),this._flagSubtractions&&this.subtractions.forEach(a.group.removeChild,i),this._flagOrder&&this.children.forEach(a.group.orderChild,i),this._flagMask&&(this._mask?this._renderer.elem.setAttribute("clip-path","url(#"+this._mask.id+")"):this._renderer.elem.removeAttribute("clip-path")),this.flagReset()}},path:{render:function(t){if(this._update(),0===this._opacity&&!this._flagOpacity)return this;var e={},i=this._matrix.manual||this._flagMatrix;if(i&&(e.transform="matrix("+this._matrix.toString()+")"),this._flagVertices){var r=a.toString(this._vertices,this._closed);e.d=r}if(this._flagFill&&(this._fill&&this._fill._renderer&&a[this._fill._renderer.type].render.call(this._fill,t),e.fill=this._fill&&this._fill.id?"url(#"+this._fill.id+")":this._fill),this._flagStroke&&(this._stroke&&this._stroke._renderer&&a[this._stroke._renderer.type].render.call(this._stroke,t),e.stroke=this._stroke&&this._stroke.id?"url(#"+this._stroke.id+")":this._stroke),this._flagLinewidth&&(e["stroke-width"]=this._linewidth),this._flagOpacity&&(e["stroke-opacity"]=this._opacity,e["fill-opacity"]=this._opacity),this._flagVisible&&(e.visibility=this._visible?"visible":"hidden"),this._flagCap&&(e["stroke-linecap"]=this._cap),this._flagJoin&&(e["stroke-linejoin"]=this._join),this._flagMiter&&(e["stroke-miterlimit"]=this._miter),this._renderer.elem?a.setAttributes(this._renderer.elem,e):(e.id=this.id,this._renderer.elem=a.createElement("path",e),t.appendChild(this._renderer.elem)),this._flagClip){var n=a.getClip(this),s=this._renderer.elem;this._clip?(s.removeAttribute("id"),n.setAttribute("id",this.id),n.appendChild(s)):(n.removeAttribute("id"),s.setAttribute("id",this.id),this.parent._renderer.elem.appendChild(s))}return this.flagReset()}},text:{render:function(t){this._update();var e={},i=this._matrix.manual||this._flagMatrix;if(i&&(e.transform="matrix("+this._matrix.toString()+")"),this._flagFamily&&(e["font-family"]=this._family),this._flagSize&&(e["font-size"]=this._size),this._flagLeading&&(e["line-height"]=this._leading),this._flagAlignment&&(e["text-anchor"]=a.alignments[this._alignment]||this._alignment),this._flagBaseline&&(e["alignment-baseline"]=e["dominant-baseline"]=this._baseline),this._flagStyle&&(e["font-style"]=this._style),this._flagWeight&&(e["font-weight"]=this._weight),this._flagDecoration&&(e["text-decoration"]=this._decoration),this._flagFill&&(e.fill=this._fill&&this._fill.id?"url(#"+this._fill.id+")":this._fill),this._flagStroke&&(e.stroke=this._stroke&&this._stroke.id?"url(#"+this._stroke.id+")":this._stroke),this._flagLinewidth&&(e["stroke-width"]=this._linewidth),this._flagOpacity&&(e.opacity=this._opacity),this._flagVisible&&(e.visibility=this._visible?"visible":"hidden"),this._renderer.elem?a.setAttributes(this._renderer.elem,e):(e.id=this.id,this._renderer.elem=a.createElement("text",e),t.defs.appendChild(this._renderer.elem)),this._flagClip){var r=a.getClip(this),n=this._renderer.elem;this._clip?(n.removeAttribute("id"),r.setAttribute("id",this.id),r.appendChild(n)):(r.removeAttribute("id"),n.setAttribute("id",this.id),this.parent._renderer.elem.appendChild(n))}return this._flagValue&&(this._renderer.elem.textContent=this._value),this.flagReset()}},"linear-gradient":{render:function(t){this._update();var e={};if(this._flagEndPoints&&(e.x1=this.left._x,e.y1=this.left._y,e.x2=this.right._x,e.y2=this.right._y),this._flagSpread&&(e.spreadMethod=this._spread),this._renderer.elem?a.setAttributes(this._renderer.elem,e):(e.id=this.id,e.gradientUnits="userSpaceOnUse",this._renderer.elem=a.createElement("linearGradient",e),t.defs.appendChild(this._renderer.elem)),this._flagStops){this._renderer.elem.childNodes.length=0;for(var i=0;i<this.stops.length;i++){var r=this.stops[i],n={};r._flagOffset&&(n.offset=100*r._offset+"%"),r._flagColor&&(n["stop-color"]=r._color),r._flagOpacity&&(n["stop-opacity"]=r._opacity),r._renderer.elem?a.setAttributes(r._renderer.elem,n):r._renderer.elem=a.createElement("stop",n),this._renderer.elem.appendChild(r._renderer.elem),r.flagReset()}}return this.flagReset()}},"radial-gradient":{render:function(t){this._update();var e={};if(this._flagCenter&&(e.cx=this.center._x,e.cy=this.center._y),this._flagFocal&&(e.fx=this.focal._x,e.fy=this.focal._y),this._flagRadius&&(e.r=this._radius),this._flagSpread&&(e.spreadMethod=this._spread),this._renderer.elem?a.setAttributes(this._renderer.elem,e):(e.id=this.id,e.gradientUnits="userSpaceOnUse",this._renderer.elem=a.createElement("radialGradient",e),t.defs.appendChild(this._renderer.elem)),this._flagStops){this._renderer.elem.childNodes.length=0;for(var i=0;i<this.stops.length;i++){var r=this.stops[i],n={};r._flagOffset&&(n.offset=100*r._offset+"%"),r._flagColor&&(n["stop-color"]=r._color),r._flagOpacity&&(n["stop-opacity"]=r._opacity),r._renderer.elem?a.setAttributes(r._renderer.elem,n):r._renderer.elem=a.createElement("stop",n),this._renderer.elem.appendChild(r._renderer.elem),r.flagReset()}}return this.flagReset()}}},o=t[t.Types.svg]=function(e){this.domElement=e.domElement||a.createElement("svg"),this.scene=new t.Group,this.scene.parent=this,this.defs=a.createElement("defs"),this.domElement.appendChild(this.defs),this.domElement.defs=this.defs,this.domElement.style.overflow="hidden"};e.extend(o,{Utils:a}),e.extend(o.prototype,i.Events,{setSize:function(t,e){return this.width=t,this.height=e,a.setAttributes(this.domElement,{width:t,height:e}),this},render:function(){return a.group.render.call(this.scene,this.domElement),this}})}(this.Two,"function"!=typeof require||"function"==typeof define&&define.amd?this._:require("underscore"),"function"!=typeof require||"function"==typeof define&&define.amd?this.Backbone:require("backbone"),"function"!=typeof require||"function"==typeof define&&define.amd?this.requestAnimationFrame:require("requestAnimationFrame")),function(t,e,i,r){var n=t.Utils.mod,s=t.Utils.toFixed,a=t.Utils.getRatio,o=function(t){return 1==t[0]&&0==t[3]&&0==t[1]&&1==t[4]&&0==t[2]&&0==t[5]},l={isHidden:/(none|transparent)/i,alignments:{left:"start",middle:"center",right:"end"},group:{renderChild:function(t){l[t._renderer.type].render.call(t,this.ctx,!0,this.clip)},render:function(t){this._update();var e=this._matrix.elements,i=this.parent;this._renderer.opacity=this._opacity*(i&&i._renderer?i._renderer.opacity:1);var r=o(e),n=this._mask;this._renderer.context||(this._renderer.context={}),this._renderer.context.ctx=t,r||(t.save(),t.transform(e[0],e[3],e[1],e[4],e[2],e[5])),n&&l[n._renderer.type].render.call(n,t,!0);for(var s=0;s<this.children.length;s++){var a=this.children[s];l[a._renderer.type].render.call(a,t)}return r||t.restore(),this.flagReset()}},path:{render:function(i,r,a){var h,c,u,f,d,p,g,_,m,y,v,b,x,A,w,k,E,S,C,M,F,q,P,O,R,T,U,j,B,L,N;if(this._update(),h=this._matrix.elements,c=this._stroke,u=this._linewidth,f=this._fill,d=this._opacity*this.parent._renderer.opacity,p=this._visible,g=this._cap,_=this._join,m=this._miter,y=this._closed,v=this._vertices,b=v.length,x=b-1,N=o(h),L=this._clip,!r&&(!p||L))return this;N||(i.save(),i.transform(h[0],h[3],h[1],h[4],h[2],h[5])),f&&(e.isString(f)?i.fillStyle=f:(l[f._renderer.type].render.call(f,i),i.fillStyle=f._renderer.gradient)),c&&(e.isString(c)?i.strokeStyle=c:(l[c._renderer.type].render.call(c,i),i.strokeStyle=c._renderer.gradient)),u&&(i.lineWidth=u),m&&(i.miterLimit=m),_&&(i.lineJoin=_),g&&(i.lineCap=g),e.isNumber(d)&&(i.globalAlpha=d),i.beginPath();for(var I=0;I<v.length;I++)switch(E=v[I],j=s(E._x),B=s(E._y),E._command){case t.Commands.close:i.closePath();break;case t.Commands.curve:w=y?n(I-1,b):Math.max(I-1,0),A=y?n(I+1,b):Math.min(I+1,x),k=v[w],S=v[A],O=k.controls&&k.controls.right||k,R=E.controls&&E.controls.left||E,k._relative?(q=O.x+s(k._x),P=O.y+s(k._y)):(q=s(O.x),P=s(O.y)),E._relative?(M=R.x+s(E._x),F=R.y+s(E._y)):(M=s(R.x),F=s(R.y)),i.bezierCurveTo(q,P,M,F,j,B),I>=x&&y&&(S=C,T=E.controls&&E.controls.right||E,U=S.controls&&S.controls.left||S,E._relative?(q=T.x+s(E._x),P=T.y+s(E._y)):(q=s(T.x),P=s(T.y)),S._relative?(M=U.x+s(S._x),F=U.y+s(S._y)):(M=s(U.x),F=s(U.y)),j=s(S._x),B=s(S._y),i.bezierCurveTo(q,P,M,F,j,B));break;case t.Commands.line:i.lineTo(j,B);break;case t.Commands.move:C=E,i.moveTo(j,B)}return y&&i.closePath(),L||a||(l.isHidden.test(f)||i.fill(),l.isHidden.test(c)||i.stroke()),N||i.restore(),L&&!a&&i.clip(),this.flagReset()}},"linear-gradient":{render:function(t){if(this._update(),!this._renderer.gradient||this._flagEndPoints||this._flagStops){this._renderer.gradient=t.createLinearGradient(this.left._x,this.left._y,this.right._x,this.right._y);for(var e=0;e<this.stops.length;e++){
var i=this.stops[e];this._renderer.gradient.addColorStop(i._offset,i._color)}}return this.flagReset()}},text:{render:function(t,i,r){this._update();var n=this._matrix.elements,s=this._stroke,a=this._linewidth,h=this._fill,c=this._opacity*this.parent._renderer.opacity,u=this._visible,f=o(n),d=this._clip;return i||u&&!d?(f||(t.save(),t.transform(n[0],n[3],n[1],n[4],n[2],n[5])),t.font=[this._style,this._weight,this._size+"px/"+this._leading+"px",this._family].join(" "),t.textAlign=l.alignments[this._alignment]||this._alignment,t.textBaseline=this._baseline,h&&(e.isString(h)?t.fillStyle=h:(l[h._renderer.type].render.call(h,t),t.fillStyle=h._renderer.gradient)),s&&(e.isString(s)?t.strokeStyle=s:(l[s._renderer.type].render.call(s,t),t.strokeStyle=s._renderer.gradient)),a&&(t.lineWidth=a),e.isNumber(c)&&(t.globalAlpha=c),d||r||(l.isHidden.test(h)||t.fillText(this.value,0,0),l.isHidden.test(s)||t.strokeText(this.value,0,0)),f||t.restore(),d&&!r&&t.clip(),this.flagReset()):this}},"radial-gradient":{render:function(t){if(this._update(),!this._renderer.gradient||this._flagCenter||this._flagFocal||this._flagRadius||this._flagStops){this._renderer.gradient=t.createRadialGradient(this.center._x,this.center._y,0,this.focal._x,this.focal._y,this._radius);for(var e=0;e<this.stops.length;e++){var i=this.stops[e];this._renderer.gradient.addColorStop(i._offset,i._color)}}return this.flagReset()}}},h=t[t.Types.canvas]=function(e){var i=e.smoothing!==!1;this.domElement=e.domElement||document.createElement("canvas"),this.ctx=this.domElement.getContext("2d"),this.overdraw=e.overdraw||!1,this.ctx.imageSmoothingEnabled=i,this.ctx.mozImageSmoothingEnabled=i,this.ctx.oImageSmoothingEnabled=i,this.ctx.webkitImageSmoothingEnabled=i,this.ctx.imageSmoothingEnabled=i,this.scene=new t.Group,this.scene.parent=this};e.extend(h,{Utils:l}),e.extend(h.prototype,i.Events,{setSize:function(t,i,r){return this.width=t,this.height=i,this.ratio=e.isUndefined(r)?a(this.ctx):r,this.domElement.width=t*this.ratio,this.domElement.height=i*this.ratio,e.extend(this.domElement.style,{width:t+"px",height:i+"px"}),this},render:function(){var t=1===this.ratio;return t||(this.ctx.save(),this.ctx.scale(this.ratio,this.ratio)),this.overdraw||this.ctx.clearRect(0,0,this.width,this.height),l.group.render.call(this.scene,this.ctx),t||this.ctx.restore(),this}})}(this.Two,"function"!=typeof require||"function"==typeof define&&define.amd?this._:require("underscore"),"function"!=typeof require||"function"==typeof define&&define.amd?this.Backbone:require("backbone"),"function"!=typeof require||"function"==typeof define&&define.amd?this.requestAnimationFrame:require("requestAnimationFrame")),function(t,e,i,r){var n=t.Matrix.Multiply,s=t.Utils.mod,a=[1,0,0,0,1,0,0,0,1],o=new t.Array(9),l=t.Utils.getRatio,h=(t.Utils.getComputedMatrix,t.Utils.toFixed),c={isHidden:/(none|transparent)/i,canvas:document.createElement("canvas"),alignments:{left:"start",middle:"center",right:"end"},matrix:new t.Matrix,uv:new t.Array([0,0,1,0,0,1,0,1,1,0,1,1]),group:{removeChild:function(t,e){if(t.children)for(var i=0;i<t.children.length;i++)c.group.removeChild(t.children[i],e);else e.deleteTexture(t._renderer.texture),delete t._renderer.texture},renderChild:function(t){c[t._renderer.type].render.call(t,this.gl,this.program)},render:function(e,i){this._update();var r=this.parent,s=r._matrix&&r._matrix.manual||r._flagMatrix,a=this._matrix.manual||this._flagMatrix;if((s||a)&&(this._renderer.matrix||(this._renderer.matrix=new t.Array(9)),this._matrix.toArray(!0,o),n(o,r._renderer.matrix,this._renderer.matrix),this._renderer.scale=this._scale*r._renderer.scale,s&&(this._flagMatrix=!0)),this._mask&&(e.enable(e.STENCIL_TEST),e.stencilFunc(e.ALWAYS,1,1),e.colorMask(!1,!1,!1,!0),e.stencilOp(e.KEEP,e.KEEP,e.INCR),c[this._mask._renderer.type].render.call(this._mask,e,i,this),e.colorMask(!0,!0,!0,!0),e.stencilFunc(e.NOTEQUAL,0,1),e.stencilOp(e.KEEP,e.KEEP,e.KEEP)),this._flagOpacity=r._flagOpacity||this._flagOpacity,this._renderer.opacity=this._opacity*(r&&r._renderer?r._renderer.opacity:1),this._flagSubtractions)for(var l=0;l<this.subtractions.length;l++)c.group.removeChild(this.subtractions[l],e);return this.children.forEach(c.group.renderChild,{gl:e,program:i}),this._mask&&(e.colorMask(!1,!1,!1,!1),e.stencilOp(e.KEEP,e.KEEP,e.DECR),c[this._mask._renderer.type].render.call(this._mask,e,i,this),e.colorMask(!0,!0,!0,!0),e.stencilFunc(e.NOTEQUAL,0,1),e.stencilOp(e.KEEP,e.KEEP,e.KEEP),e.disable(e.STENCIL_TEST)),this.flagReset()}},path:{updateCanvas:function(i){var r,n,a,o,l,u,f,d,p,g,_,m,y,v,x=i._vertices,A=this.canvas,w=this.ctx,k=i._renderer.scale,E=i._stroke,S=i._linewidth,C=i._fill,M=i._renderer.opacity||i._opacity,F=i._cap,q=i._join,P=i._miter,O=i._closed,R=x.length,T=R-1;A.width=Math.max(Math.ceil(i._renderer.rect.width*k),1),A.height=Math.max(Math.ceil(i._renderer.rect.height*k),1);var U=i._renderer.rect.centroid,j=U.x,B=U.y;w.clearRect(0,0,A.width,A.height),C&&(e.isString(C)?w.fillStyle=C:(c[C._renderer.type].render.call(C,w,i),w.fillStyle=C._renderer.gradient)),E&&(e.isString(E)?w.strokeStyle=E:(c[E._renderer.type].render.call(E,w,i),w.strokeStyle=E._renderer.gradient)),S&&(w.lineWidth=S),P&&(w.miterLimit=P),q&&(w.lineJoin=q),F&&(w.lineCap=F),e.isNumber(M)&&(w.globalAlpha=M);var L;w.save(),w.scale(k,k),w.translate(j,B),w.beginPath();for(var N=0;N<x.length;N++)switch(b=x[N],y=h(b._x),v=h(b._y),b._command){case t.Commands.close:w.closePath();break;case t.Commands.curve:n=O?s(N-1,R):Math.max(N-1,0),r=O?s(N+1,R):Math.min(N+1,T),a=x[n],o=x[r],p=a.controls&&a.controls.right||a,g=b.controls&&b.controls.left||b,a._relative?(f=h(p.x+a._x),d=h(p.y+a._y)):(f=h(p.x),d=h(p.y)),b._relative?(l=h(g.x+b._x),u=h(g.y+b._y)):(l=h(g.x),u=h(g.y)),w.bezierCurveTo(f,d,l,u,y,v),N>=T&&O&&(o=L,_=b.controls&&b.controls.right||b,m=o.controls&&o.controls.left||o,b._relative?(f=h(_.x+b._x),d=h(_.y+b._y)):(f=h(_.x),d=h(_.y)),o._relative?(l=h(m.x+o._x),u=h(m.y+o._y)):(l=h(m.x),u=h(m.y)),y=h(o._x),v=h(o._y),w.bezierCurveTo(f,d,l,u,y,v));break;case t.Commands.line:w.lineTo(y,v);break;case t.Commands.move:L=b,w.moveTo(y,v)}O&&w.closePath(),c.isHidden.test(C)||w.fill(),c.isHidden.test(E)||w.stroke(),w.restore()},getBoundingClientRect:function(t,i,r){var n,s,a=1/0,o=-(1/0),l=1/0,h=-(1/0);t.forEach(function(t){var e,i,r,n,s,c,u=t.x,f=t.y,d=t.controls;l=Math.min(f,l),a=Math.min(u,a),o=Math.max(u,o),h=Math.max(f,h),t.controls&&(s=d.left,c=d.right,s&&c&&(e=t._relative?s.x+u:s.x,i=t._relative?s.y+f:s.y,r=t._relative?c.x+u:c.x,n=t._relative?c.y+f:c.y,e&&i&&r&&n&&(l=Math.min(i,n,l),a=Math.min(e,r,a),o=Math.max(e,r,o),h=Math.max(i,n,h))))}),e.isNumber(i)&&(l-=i,a-=i,o+=i,h+=i),n=o-a,s=h-l,r.top=l,r.left=a,r.right=o,r.bottom=h,r.width=n,r.height=s,r.centroid||(r.centroid={}),r.centroid.x=-a,r.centroid.y=-l},render:function(e,i,r){if(!this._visible||!this._opacity)return this;var s=this.parent,a=s._matrix.manual||s._flagMatrix,l=this._matrix.manual||this._flagMatrix,h=this._flagVertices||this._flagFill||this._fill instanceof t.LinearGradient&&(this._fill._flagSpread||this._fill._flagStops||this._fill._flagEndPoints)||this._fill instanceof t.RadialGradient&&(this._fill._flagSpread||this._fill._flagStops||this._fill._flagRadius||this._fill._flagCenter||this._fill._flagFocal)||this._stroke instanceof t.LinearGradient&&(this._stroke._flagSpread||this._stroke._flagStops||this._stroke._flagEndPoints)||this._stroke instanceof t.RadialGradient&&(this._stroke._flagSpread||this._stroke._flagStops||this._stroke._flagRadius||this._stroke._flagCenter||this._stroke._flagFocal)||this._flagStroke||this._flagLinewidth||this._flagOpacity||s._flagOpacity||this._flagVisible||this._flagCap||this._flagJoin||this._flagMiter||this._flagScale||!this._renderer.texture;return this._update(),(a||l)&&(this._renderer.matrix||(this._renderer.matrix=new t.Array(9)),this._matrix.toArray(!0,o),n(o,s._renderer.matrix,this._renderer.matrix),this._renderer.scale=this._scale*s._renderer.scale),h&&(this._renderer.rect||(this._renderer.rect={}),this._renderer.triangles||(this._renderer.triangles=new t.Array(12)),this._renderer.opacity=this._opacity*s._renderer.opacity,c.path.getBoundingClientRect(this._vertices,this._linewidth,this._renderer.rect),c.getTriangles(this._renderer.rect,this._renderer.triangles),c.updateBuffer.call(c,e,this,i),c.updateTexture.call(c,e,this)),!this._clip||r?(e.bindBuffer(e.ARRAY_BUFFER,this._renderer.textureCoordsBuffer),e.vertexAttribPointer(i.textureCoords,2,e.FLOAT,!1,0,0),e.bindTexture(e.TEXTURE_2D,this._renderer.texture),e.uniformMatrix3fv(i.matrix,!1,this._renderer.matrix),e.bindBuffer(e.ARRAY_BUFFER,this._renderer.buffer),e.vertexAttribPointer(i.position,2,e.FLOAT,!1,0,0),e.drawArrays(e.TRIANGLES,0,6),this.flagReset()):void 0}},text:{updateCanvas:function(t){var i=this.canvas,r=this.ctx,n=t._renderer.scale,s=t._stroke,a=t._linewidth*n,o=t._fill,l=t._renderer.opacity||t._opacity;i.width=Math.max(Math.ceil(t._renderer.rect.width*n),1),i.height=Math.max(Math.ceil(t._renderer.rect.height*n),1);var h=t._renderer.rect.centroid,u=h.x,f=h.y;r.clearRect(0,0,i.width,i.height),r.font=[t._style,t._weight,t._size+"px/"+t._leading+"px",t._family].join(" "),r.textAlign="center",r.textBaseline="middle",o&&(e.isString(o)?r.fillStyle=o:(c[o._renderer.type].render.call(o,r,t),r.fillStyle=o._renderer.gradient)),s&&(e.isString(s)?r.strokeStyle=s:(c[s._renderer.type].render.call(s,r,t),r.strokeStyle=s._renderer.gradient)),a&&(r.lineWidth=a),e.isNumber(l)&&(r.globalAlpha=l),r.save(),r.scale(n,n),r.translate(u,f),c.isHidden.test(o)||r.fillText(t.value,0,0),c.isHidden.test(s)||r.strokeText(t.value,0,0),r.restore()},getBoundingClientRect:function(t,e){var i=c.ctx;i.font=[t._style,t._weight,t._size+"px/"+t._leading+"px",t._family].join(" "),i.textAlign="center",i.textBaseline=t._baseline;var r=i.measureText(t._value).width,n=Math.max(t._size||t._leading);this._linewidth&&!c.isHidden.test(this._stroke)&&(n+=this._linewidth);var s=r/2,a=n/2;switch(c.alignments[t._alignment]||t._alignment){case c.alignments.left:e.left=0,e.right=r;break;case c.alignments.right:e.left=-r,e.right=0;break;default:e.left=-s,e.right=s}switch(t._baseline){case"bottom":e.top=-n,e.bottom=0;break;case"top":e.top=0,e.bottom=n;break;default:e.top=-a,e.bottom=a}e.width=r,e.height=n,e.centroid||(e.centroid={}),e.centroid.x=s,e.centroid.y=a},render:function(e,i,r){if(!this._visible||!this._opacity)return this;var s=this.parent,a=s._matrix.manual||s._flagMatrix,l=this._matrix.manual||this._flagMatrix,h=this._flagVertices||this._flagFill||this._fill instanceof t.LinearGradient&&(this._fill._flagSpread||this._fill._flagStops||this._fill._flagEndPoints)||this._fill instanceof t.RadialGradient&&(this._fill._flagSpread||this._fill._flagStops||this._fill._flagRadius||this._fill._flagCenter||this._fill._flagFocal)||this._stroke instanceof t.LinearGradient&&(this._stroke._flagSpread||this._stroke._flagStops||this._stroke._flagEndPoints)||this._stroke instanceof t.RadialGradient&&(this._stroke._flagSpread||this._stroke._flagStops||this._stroke._flagRadius||this._stroke._flagCenter||this._stroke._flagFocal)||this._flagStroke||this._flagLinewidth||this._flagOpacity||s._flagOpacity||this._flagVisible||this._flagScale||this._flagValue||this._flagFamily||this._flagSize||this._flagLeading||this._flagAlignment||this._flagBaseline||this._flagStyle||this._flagWeight||this._flagDecoration||!this._renderer.texture;return this._update(),(a||l)&&(this._renderer.matrix||(this._renderer.matrix=new t.Array(9)),this._matrix.toArray(!0,o),n(o,s._renderer.matrix,this._renderer.matrix),this._renderer.scale=this._scale*s._renderer.scale),h&&(this._renderer.rect||(this._renderer.rect={}),this._renderer.triangles||(this._renderer.triangles=new t.Array(12)),this._renderer.opacity=this._opacity*s._renderer.opacity,c.text.getBoundingClientRect(this,this._renderer.rect),c.getTriangles(this._renderer.rect,this._renderer.triangles),c.updateBuffer.call(c,e,this,i),c.updateTexture.call(c,e,this)),!this._clip||r?(e.bindBuffer(e.ARRAY_BUFFER,this._renderer.textureCoordsBuffer),e.vertexAttribPointer(i.textureCoords,2,e.FLOAT,!1,0,0),e.bindTexture(e.TEXTURE_2D,this._renderer.texture),e.uniformMatrix3fv(i.matrix,!1,this._renderer.matrix),e.bindBuffer(e.ARRAY_BUFFER,this._renderer.buffer),e.vertexAttribPointer(i.position,2,e.FLOAT,!1,0,0),e.drawArrays(e.TRIANGLES,0,6),this.flagReset()):void 0}},"linear-gradient":{render:function(t,e){if(t.canvas.getContext("2d")){if(this._update(),!this._renderer.gradient||this._flagEndPoints||this._flagStops){this._renderer.gradient=t.createLinearGradient(this.left._x,this.left._y,this.right._x,this.right._y);for(var i=0;i<this.stops.length;i++){var r=this.stops[i];this._renderer.gradient.addColorStop(r._offset,r._color)}}return this.flagReset()}}},"radial-gradient":{render:function(t,e){if(t.canvas.getContext("2d")){if(this._update(),!this._renderer.gradient||this._flagCenter||this._flagFocal||this._flagRadius||this._flagStops){this._renderer.gradient=t.createRadialGradient(this.center._x,this.center._y,0,this.focal._x,this.focal._y,this._radius);for(var i=0;i<this.stops.length;i++){var r=this.stops[i];this._renderer.gradient.addColorStop(r._offset,r._color)}}return this.flagReset()}}},getTriangles:function(t,e){var i=t.top,r=t.left,n=t.right,s=t.bottom;e[0]=r,e[1]=i,e[2]=n,e[3]=i,e[4]=r,e[5]=s,e[6]=r,e[7]=s,e[8]=n,e[9]=i,e[10]=n,e[11]=s},updateTexture:function(t,e){this[e._renderer.type].updateCanvas.call(c,e),e._renderer.texture&&t.deleteTexture(e._renderer.texture),t.bindBuffer(t.ARRAY_BUFFER,e._renderer.textureCoordsBuffer),e._renderer.texture=t.createTexture(),t.bindTexture(t.TEXTURE_2D,e._renderer.texture),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),this.canvas.width<=0||this.canvas.height<=0||t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,this.canvas)},updateBuffer:function(t,i,r){e.isObject(i._renderer.buffer)&&t.deleteBuffer(i._renderer.buffer),i._renderer.buffer=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,i._renderer.buffer),t.enableVertexAttribArray(r.position),t.bufferData(t.ARRAY_BUFFER,i._renderer.triangles,t.STATIC_DRAW),e.isObject(i._renderer.textureCoordsBuffer)&&t.deleteBuffer(i._renderer.textureCoordsBuffer),i._renderer.textureCoordsBuffer=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,i._renderer.textureCoordsBuffer),t.enableVertexAttribArray(r.textureCoords),t.bufferData(t.ARRAY_BUFFER,this.uv,t.STATIC_DRAW)},program:{create:function(i,r){var n,s,a;if(n=i.createProgram(),e.each(r,function(t){i.attachShader(n,t)}),i.linkProgram(n),s=i.getProgramParameter(n,i.LINK_STATUS),!s)throw a=i.getProgramInfoLog(n),i.deleteProgram(n),new t.Utils.Error("unable to link program: "+a);return n}},shaders:{create:function(e,i,r){var n,s,a;if(n=e.createShader(e[r]),e.shaderSource(n,i),e.compileShader(n),s=e.getShaderParameter(n,e.COMPILE_STATUS),!s)throw a=e.getShaderInfoLog(n),e.deleteShader(n),new t.Utils.Error("unable to compile shader "+n+": "+a);return n},types:{vertex:"VERTEX_SHADER",fragment:"FRAGMENT_SHADER"},vertex:["attribute vec2 a_position;","attribute vec2 a_textureCoords;","","uniform mat3 u_matrix;","uniform vec2 u_resolution;","","varying vec2 v_textureCoords;","","void main() {","   vec2 projected = (u_matrix * vec3(a_position, 1.0)).xy;","   vec2 normal = projected / u_resolution;","   vec2 clipspace = (normal * 2.0) - 1.0;","","   gl_Position = vec4(clipspace * vec2(1.0, -1.0), 0.0, 1.0);","   v_textureCoords = a_textureCoords;","}"].join("\n"),fragment:["precision mediump float;","","uniform sampler2D u_image;","varying vec2 v_textureCoords;","","void main() {","  gl_FragColor = texture2D(u_image, v_textureCoords);","}"].join("\n")}};c.ctx=c.canvas.getContext("2d");var u=t[t.Types.webgl]=function(i){var r,n,s,o;if(this.domElement=i.domElement||document.createElement("canvas"),this.scene=new t.Group,this.scene.parent=this,this._renderer={matrix:new t.Array(a),scale:1,opacity:1},this._flagMatrix=!0,r=e.defaults(i||{},{antialias:!1,alpha:!0,premultipliedAlpha:!0,stencil:!0,preserveDrawingBuffer:!0,overdraw:!1}),this.overdraw=r.overdraw,n=this.ctx=this.domElement.getContext("webgl",r)||this.domElement.getContext("experimental-webgl",r),!this.ctx)throw new t.Utils.Error("unable to create a webgl context. Try using another renderer.");s=c.shaders.create(n,c.shaders.vertex,c.shaders.types.vertex),o=c.shaders.create(n,c.shaders.fragment,c.shaders.types.fragment),this.program=c.program.create(n,[s,o]),n.useProgram(this.program),this.program.position=n.getAttribLocation(this.program,"a_position"),this.program.matrix=n.getUniformLocation(this.program,"u_matrix"),this.program.textureCoords=n.getAttribLocation(this.program,"a_textureCoords"),n.disable(n.DEPTH_TEST),n.enable(n.BLEND),n.blendEquationSeparate(n.FUNC_ADD,n.FUNC_ADD),n.blendFuncSeparate(n.SRC_ALPHA,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA)};e.extend(u.prototype,i.Events,{setSize:function(t,i,r){this.width=t,this.height=i,this.ratio=e.isUndefined(r)?l(this.ctx):r,this.domElement.width=t*this.ratio,this.domElement.height=i*this.ratio,e.extend(this.domElement.style,{width:t+"px",height:i+"px"}),t*=this.ratio,i*=this.ratio,this._renderer.matrix[0]=this._renderer.matrix[4]=this._renderer.scale=this.ratio,this._flagMatrix=!0,this.ctx.viewport(0,0,t,i);var n=this.ctx.getUniformLocation(this.program,"u_resolution");return this.ctx.uniform2f(n,t,i),this},render:function(){var t=this.ctx;return this.overdraw||t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT),c.group.render.call(this.scene,t,this.program),this._flagMatrix=!1,this}})}(this.Two,"function"!=typeof require||"function"==typeof define&&define.amd?this._:require("underscore"),"function"!=typeof require||"function"==typeof define&&define.amd?this.Backbone:require("backbone"),"function"!=typeof require||"function"==typeof define&&define.amd?this.requestAnimationFrame:require("requestAnimationFrame")),function(t,e,i,r){var n=t.Shape=function(){this._renderer={},this.id=t.Identifier+t.uniqueId(),this.classList=[],this._matrix=new t.Matrix,this.translation=new t.Vector,this.translation.bind(t.Events.change,e.bind(n.FlagMatrix,this)),this.rotation=0,this.scale=1};e.extend(n,i.Events,{FlagMatrix:function(){this._flagMatrix=!0},MakeObservable:function(t){Object.defineProperty(t,"rotation",{get:function(){return this._rotation},set:function(t){this._rotation=t,this._flagMatrix=!0}}),Object.defineProperty(t,"scale",{get:function(){return this._scale},set:function(t){this._scale=t,this._flagMatrix=!0,this._flagScale=!0}})}}),e.extend(n.prototype,{_flagMatrix:!0,_rotation:0,_scale:1,addTo:function(t){return t.add(this),this},clone:function(){var t=new n;return t.translation.copy(this.translation),t.rotation=this.rotation,t.scale=this.scale,e.each(n.Properties,function(e){t[e]=this[e]},this),t._update()},_update:function(t){return!this._matrix.manual&&this._flagMatrix&&this._matrix.identity().translate(this.translation.x,this.translation.y).scale(this.scale).rotate(this.rotation),t&&this.parent&&this.parent._update&&this.parent._update(),this},flagReset:function(){return this._flagMatrix=this._flagScale=!1,this}}),n.MakeObservable(n.prototype)}(this.Two,"function"!=typeof require||"function"==typeof define&&define.amd?this._:require("underscore"),"function"!=typeof require||"function"==typeof define&&define.amd?this.Backbone:require("backbone"),"function"!=typeof require||"function"==typeof define&&define.amd?this.requestAnimationFrame:require("requestAnimationFrame")),function(t,e,i,r){function n(e,i,r){var n,s,a,o,l,h,c,u,f=i.controls&&i.controls.right,d=e.controls&&e.controls.left;return n=i.x,l=i.y,s=(f||i).x,h=(f||i).y,a=(d||e).x,c=(d||e).y,o=e.x,u=e.y,f&&i._relative&&(s+=i.x,h+=i.y),d&&e._relative&&(a+=e.x,c+=e.y),t.Utils.getCurveLength(n,l,s,h,a,c,o,u,r)}function s(e,i,r){var n,s,a,o,l,h,c,u,f=i.controls&&i.controls.right,d=e.controls&&e.controls.left;return n=i.x,l=i.y,s=(f||i).x,h=(f||i).y,a=(d||e).x,c=(d||e).y,o=e.x,u=e.y,f&&i._relative&&(s+=i.x,h+=i.y),d&&e._relative&&(a+=e.x,c+=e.y),t.Utils.subdivide(n,l,s,h,a,c,o,u,r)}var a=Math.min,o=Math.max,l=Math.round,h=t.Utils.getComputedMatrix,c={};e.each(t.Commands,function(t,e){c[e]=new RegExp(t)});var u=t.Path=function(e,i,r,n){t.Shape.call(this),this._renderer.type="path",this._closed=!!i,this._curved=!!r,this.beginning=0,this.ending=1,this.fill="#fff",this.stroke="#000",this.linewidth=1,this.opacity=1,this.visible=!0,this.cap="butt",this.join="miter",this.miter=4,this._vertices=[],this.vertices=e,this.automatic=!n};e.extend(u,{Properties:["fill","stroke","linewidth","opacity","visible","cap","join","miter","closed","curved","automatic","beginning","ending"],FlagVertices:function(){this._flagVertices=!0,this._flagLength=!0},MakeObservable:function(i){t.Shape.MakeObservable(i),e.each(u.Properties.slice(0,8),function(t){var e="_"+t,r="_flag"+t.charAt(0).toUpperCase()+t.slice(1);Object.defineProperty(i,t,{get:function(){return this[e]},set:function(t){this[e]=t,this[r]=!0}})}),Object.defineProperty(i,"length",{get:function(){return this._flagLength&&this._updateLength(),this._length}}),Object.defineProperty(i,"closed",{get:function(){return this._closed},set:function(t){this._closed=!!t,this._flagVertices=!0}}),Object.defineProperty(i,"curved",{get:function(){return this._curved},set:function(t){this._curved=!!t,this._flagVertices=!0}}),Object.defineProperty(i,"automatic",{get:function(){return this._automatic},set:function(t){if(t!==this._automatic){this._automatic=!!t;var i=this._automatic?"ignore":"listen";e.each(this.vertices,function(t){t[i]()})}}}),Object.defineProperty(i,"beginning",{get:function(){return this._beginning},set:function(t){this._beginning=a(o(t,0),this._ending),this._flagVertices=!0}}),Object.defineProperty(i,"ending",{get:function(){return this._ending},set:function(t){this._ending=a(o(t,this._beginning),1),this._flagVertices=!0}}),Object.defineProperty(i,"vertices",{get:function(){return this._collection},set:function(i){var r=e.bind(u.FlagVertices,this),n=e.bind(function(e){for(var i=e.length;i--;)e[i].bind(t.Events.change,r);r()},this),s=e.bind(function(i){e.each(i,function(e){e.unbind(t.Events.change,r)},this),r()},this);this._collection&&this._collection.unbind(),this._collection=new t.Utils.Collection((i||[]).slice(0)),this._collection.bind(t.Events.insert,n),this._collection.bind(t.Events.remove,s),n(this._collection)}}),Object.defineProperty(i,"clip",{get:function(){return this._clip},set:function(t){this._clip=t,this._flagClip=!0}})}}),e.extend(u.prototype,t.Shape.prototype,{_flagVertices:!0,_flagLength:!0,_flagFill:!0,_flagStroke:!0,_flagLinewidth:!0,_flagOpacity:!0,_flagVisible:!0,_flagCap:!0,_flagJoin:!0,_flagMiter:!0,_flagClip:!1,_length:0,_fill:"#fff",_stroke:"#000",_linewidth:1,_opacity:1,_visible:!0,_cap:"round",_join:"round",_miter:4,_closed:!0,_curved:!1,_automatic:!0,_beginning:0,_ending:1,_clip:!1,clone:function(i){i=i||this.parent;var r=e.map(this.vertices,function(t){return t.clone()}),n=new u(r,this.closed,this.curved,(!this.automatic));return e.each(t.Path.Properties,function(t){n[t]=this[t]},this),n.translation.copy(this.translation),n.rotation=this.rotation,n.scale=this.scale,i.add(n),n},toObject:function(){var i={vertices:e.map(this.vertices,function(t){return t.toObject()})};return e.each(t.Shape.Properties,function(t){i[t]=this[t]},this),i.translation=this.translation.toObject,i.rotation=this.rotation,i.scale=this.scale,i},noFill:function(){return this.fill="transparent",this},noStroke:function(){return this.stroke="transparent",this},corner:function(){var t=this.getBoundingClientRect(!0);return t.centroid={x:t.left+t.width/2,y:t.top+t.height/2},e.each(this.vertices,function(e){e.addSelf(t.centroid)}),this},center:function(){var t=this.getBoundingClientRect(!0);return t.centroid={x:t.left+t.width/2,y:t.top+t.height/2},e.each(this.vertices,function(e){e.subSelf(t.centroid)}),this},remove:function(){return this.parent?(this.parent.remove(this),this):this},getBoundingClientRect:function(t){var e,i,r,n,s,l,c,u=1/0,f=-(1/0),d=1/0,p=-(1/0);for(this._update(!0),e=t?this._matrix:h(this),i=this.linewidth/2,r=this._vertices.length,l=0;l<r;l++)c=this._vertices[l],n=c.x,s=c.y,c=e.multiply(n,s,1),d=a(c.y-i,d),u=a(c.x-i,u),f=o(c.x+i,f),p=o(c.y+i,p);return{top:d,left:u,right:f,bottom:p,width:f-u,height:p-d}},getPointAt:function(i,r){for(var n,s,a,o,l,h,c,u,f,d,p,g,_=this.length*Math.min(Math.max(i,0),1),m=this.vertices.length,y=m-1,v=null,b=null,x=0,A=this._lengths.length,w=0;x<A;x++){if(w+this._lengths[x]>_){v=this.vertices[this.closed?t.Utils.mod(x,m):x],b=this.vertices[Math.min(Math.max(x-1,0),y)],_-=w,i=_/this._lengths[x];break}w+=this._lengths[x]}return e.isNull(v)||e.isNull(b)?null:(g=b.controls&&b.controls.right,p=v.controls&&v.controls.left,s=b.x,c=b.y,a=(g||b).x,u=(g||b).y,o=(p||v).x,f=(p||v).y,l=v.x,d=v.y,g&&b._relative&&(a+=b.x,u+=b.y),p&&v._relative&&(o+=v.x,f+=v.y),n=t.Utils.getPointOnCubicBezier(i,s,a,o,l),h=t.Utils.getPointOnCubicBezier(i,c,u,f,d),e.isObject(r)?(r.x=n,r.y=h,r):new t.Vector(n,h))},plot:function(){if(this.curved)return t.Utils.getCurveFromPoints(this._vertices,this.closed),this;for(var e=0;e<this._vertices.length;e++)this._vertices[e]._command=0===e?t.Commands.move:t.Commands.line;return this},subdivide:function(i){this._update();var r=this.vertices.length-1,n=this.vertices[r],a=this._closed||this.vertices[r]._command===t.Commands.close,o=[];return e.each(this.vertices,function(l,h){if(h<=0&&!a)return void(n=l);if(l.command===t.Commands.move)return o.push(new t.Anchor(n.x,n.y)),h>0&&(o[o.length-1].command=t.Commands.line),void(n=l);var c=s(l,n,i);o=o.concat(c),e.each(c,function(e,i){i<=0&&n.command===t.Commands.move?e.command=t.Commands.move:e.command=t.Commands.line}),h>=r&&(this._closed&&this._automatic?(n=l,c=s(l,n,i),o=o.concat(c),e.each(c,function(e,i){i<=0&&n.command===t.Commands.move?e.command=t.Commands.move:e.command=t.Commands.line})):a&&o.push(new t.Anchor(l.x,l.y)),o[o.length-1].command=a?t.Commands.close:t.Commands.line),n=l},this),this._automatic=!1,this._curved=!1,this.vertices=o,this},_updateLength:function(i){this._update();var r=this.vertices.length-1,s=this.vertices[r],a=this._closed||this.vertices[r]._command===t.Commands.close,o=0;return e.isUndefined(this._lengths)&&(this._lengths=[]),e.each(this.vertices,function(e,l){return l<=0&&!a||e.command===t.Commands.move?(s=e,void(this._lengths[l]=0)):(this._lengths[l]=n(e,s,i),o+=this._lengths[l],l>=r&&a&&(s=e,this._lengths[l+1]=n(e,s,i),o+=this._lengths[l+1]),void(s=e))},this),this._length=o,this},_update:function(){if(this._flagVertices){var e,i=this.vertices.length,r=i-1,n=l(this._beginning*r),s=l(this._ending*r);this._vertices.length=0;for(var a=n;a<s+1;a++)e=this.vertices[a],this._vertices.push(e);this._automatic&&this.plot()}return t.Shape.prototype._update.apply(this,arguments),this},flagReset:function(){return this._flagVertices=this._flagFill=this._flagStroke=this._flagLinewidth=this._flagOpacity=this._flagVisible=this._flagCap=this._flagJoin=this._flagMiter=this._flagClip=!1,t.Shape.prototype.flagReset.call(this),this}}),u.MakeObservable(u.prototype)}(this.Two,"function"!=typeof require||"function"==typeof define&&define.amd?this._:require("underscore"),"function"!=typeof require||"function"==typeof define&&define.amd?this.Backbone:require("backbone"),"function"!=typeof require||"function"==typeof define&&define.amd?this.requestAnimationFrame:require("requestAnimationFrame")),function(t,e,i,r){var n=t.Path,s=t.Line=function(e,i,r,s){var a=r-e,o=s-i,l=a/2,h=o/2;n.call(this,[new t.Anchor((-l),(-h)),new t.Anchor(l,h)]),this.translation.set(e+l,i+h)};e.extend(s.prototype,n.prototype),n.MakeObservable(s.prototype)}(this.Two,"function"!=typeof require||"function"==typeof define&&define.amd?this._:require("underscore"),"function"!=typeof require||"function"==typeof define&&define.amd?this.Backbone:require("backbone"),"function"!=typeof require||"function"==typeof define&&define.amd?this.requestAnimationFrame:require("requestAnimationFrame")),function(t,e,i,r){var n=t.Path,s=t.Rectangle=function(e,i,r,s){var a=r/2,o=s/2;n.call(this,[new t.Anchor((-a),(-o)),new t.Anchor(a,(-o)),new t.Anchor(a,o),new t.Anchor((-a),o)],!0),this.translation.set(e,i)};e.extend(s.prototype,n.prototype),n.MakeObservable(s.prototype)}(this.Two,"function"!=typeof require||"function"==typeof define&&define.amd?this._:require("underscore"),"function"!=typeof require||"function"==typeof define&&define.amd?this.Backbone:require("backbone"),"function"!=typeof require||"function"==typeof define&&define.amd?this.requestAnimationFrame:require("requestAnimationFrame")),function(t,e,i,r){var n=t.Path,s=2*Math.PI,a=Math.cos,o=Math.sin,l=t.Ellipse=function(i,r,l,h){e.isNumber(h)||(h=l);var c=t.Resolution,u=e.map(e.range(c),function(e){var i=e/c,r=i*s,n=l*a(r),u=h*o(r);return new t.Anchor(n,u)},this);n.call(this,u,!0,!0),this.translation.set(i,r)};e.extend(l.prototype,n.prototype),n.MakeObservable(l.prototype)}(this.Two,"function"!=typeof require||"function"==typeof define&&define.amd?this._:require("underscore"),"function"!=typeof require||"function"==typeof define&&define.amd?this.Backbone:require("backbone"),"function"!=typeof require||"function"==typeof define&&define.amd?this.requestAnimationFrame:require("requestAnimationFrame")),function(t,e,i,r){var n=t.Path,s=2*Math.PI,a=Math.cos,o=Math.sin,l=t.Polygon=function(i,r,l,h){h=Math.max(h||0,3);var c=e.map(e.range(h),function(e){var i=(e+.5)/h,r=s*i+Math.PI/2,n=l*a(r),c=l*o(r);return new t.Anchor(n,c)});n.call(this,c,!0),this.translation.set(i,r)};e.extend(l.prototype,n.prototype),n.MakeObservable(l.prototype)}(this.Two,"function"!=typeof require||"function"==typeof define&&define.amd?this._:require("underscore"),"function"!=typeof require||"function"==typeof define&&define.amd?this.Backbone:require("backbone"),"function"!=typeof require||"function"==typeof define&&define.amd?this.requestAnimationFrame:require("requestAnimationFrame")),function(t,e,i,r){var n=t.Path,s=Math.PI,a=(2*Math.PI,Math.PI/2),o=Math.cos,l=Math.sin,h=(Math.abs,t.ArcSegment=function(e,i,r,h,c,u,f){c>u&&(u+=2*Math.PI),f=f||8;var d=u-c,p=d/f,g=t.Commands.move,_=[];_.push(new t.Anchor(Math.sin(0)*h,Math.cos(0)*h,0,0,0,0,g));var m,y,v,b,x,A,w;g=t.Commands.curve;for(var k=0;k<f+1;k++)m=k*p,y=l(m)*h,v=o(m)*h,b=l(m-a)*(p/s)*h,x=o(m-a)*(p/s)*h,A=l(m+a)*(p/s)*h,w=o(m+a)*(p/s)*h,0===k&&(b=x=0),k===f&&(A=w=0),_.push(new t.Anchor(y,v,b,x,A,w,g));for(var E=0;E<f+1;E++)m=d-p*E,y=l(m)*r,v=o(m)*r,b=l(m-1.5*s)*(p/s)*r,x=o(m-1.5*s)*(p/s)*r,A=l(m+1.5*s)*(p/s)*r,w=o(m+1.5*s)*(p/s)*r,0===E&&(b=x=0),E===f&&(A=w=0),_.push(new t.Anchor(y,v,b,x,A,w,g));g=t.Commands.close,_.push(new t.Anchor(Math.sin(0)*h,Math.cos(0)*h,0,0,0,0,g)),n.call(this,_,!0,!1,!0),this.rotation=c,this.translation.set(e,i)});e.extend(h.prototype,n.prototype),n.MakeObservable(h.prototype)}(this.Two,"function"!=typeof require||"function"==typeof define&&define.amd?this._:require("underscore"),"function"!=typeof require||"function"==typeof define&&define.amd?this.Backbone:require("backbone"),"function"!=typeof require||"function"==typeof define&&define.amd?this.requestAnimationFrame:require("requestAnimationFrame")),function(t,e,i,r){var n=t.Path,s=Math.PI,a=(2*Math.PI,Math.cos),o=Math.sin,l=(Math.abs,t.SineRing=function(e,i,r,l,h,c){var u=2*l+1,f=Math.PI/l,d=s*r/l/2;c=c||1;var p,g,_,m,y,v,b=[],x=s;b.push(new t.Anchor(o(x)*(r+h/2),a(x)*(r+h/2),0,0,0,0,t.Commands.move));for(var A=0;A<u;A++)x=f*A+s,A%2===0?(p=Math.sin(x)*(r+h/2),g=Math.cos(x)*(r+h/2)):(p=Math.sin(x)*(r-h/2),g=Math.cos(x)*(r-h/2)),_=Math.sin(x-Math.PI/2)*d*c,m=Math.cos(x-Math.PI/2)*d*c,y=Math.sin(x+Math.PI/2)*d*c,v=Math.cos(x+Math.PI/2)*d*c,0===A&&(_=m=0),A===u-1&&(y=v=0),b.push(new t.Anchor(p,g,_,m,y,v,t.Commands.curve));n.call(this,b,!0,!1,!0),this.translation.set(e,i)});e.extend(l.prototype,n.prototype),n.MakeObservable(l.prototype)}(this.Two,"function"!=typeof require||"function"==typeof define&&define.amd?this._:require("underscore"),"function"!=typeof require||"function"==typeof define&&define.amd?this.Backbone:require("backbone"),"function"!=typeof require||"function"==typeof define&&define.amd?this.requestAnimationFrame:require("requestAnimationFrame")),
function(t,e,i,r){var n=t.Path,s=2*Math.PI,a=Math.cos,o=Math.sin,l=t.Star=function(i,r,l,h,c){e.isNumber(h)||(h=l/2),(!e.isNumber(c)||c<=0)&&(c=5);var u=2*c,f=e.map(e.range(u),function(e){var i=(e-.5)/u,r=i*s,n=e%2?h:l,c=n*a(r),f=n*o(r);return new t.Anchor(c,f)});n.call(this,f,!0),this.translation.set(i,r)};e.extend(l.prototype,n.prototype),n.MakeObservable(l.prototype)}(this.Two,"function"!=typeof require||"function"==typeof define&&define.amd?this._:require("underscore"),"function"!=typeof require||"function"==typeof define&&define.amd?this.Backbone:require("backbone"),"function"!=typeof require||"function"==typeof define&&define.amd?this.requestAnimationFrame:require("requestAnimationFrame")),function(t,e,i,r){function n(i,r,n,a,o){var l=0,h=0,c=t.Resolution,u=(i[i.length-1],new t.Anchor(r,n),r<0?-a:a),f=n<0?-a:a;switch(o){case 1:l=-Math.PI/2,h=0;break;case 2:l=-Math.PI,h=-Math.PI/2;break;case 3:l=1.5*-Math.PI,h=-Math.PI;break;case 4:l=0,h=Math.PI/2}var d=e.map(e.range(c),function(e){var i=s(c-e,0,c,l,h),o=a*Math.cos(i)+r-u,d=a*Math.sin(i)+n-f,p=new t.Anchor(o,d);return p}).reverse();return i.concat(d)}function s(t,e,i,r,n){return r+(n-r)*((t-e)/(i-e))}var a=t.Path,o=t.RoundedRectangle=function(i,r,s,o,l){var h,c,u=s/2,f=o/2;e.isNumber(l)||(l=Math.floor(Math.min(s,o)/12));var d=[new t.Anchor(-u+l,(-f)),new t.Anchor(u-l,(-f))];h=u,c=-f,d=n(d,h,c,l,1),d.push(new t.Anchor(u,f-l)),h=u,c=f,d=n(d,h,c,l,4),d.push(new t.Anchor(-u+l,f)),h=-u,c=f,d=n(d,h,c,l,3),d.push(new t.Anchor((-u),-f+l)),h=-u,c=-f,d=n(d,h,c,l,2),d.pop(),a.call(this,d,!0),this.translation.set(i,r)};e.extend(o.prototype,a.prototype),a.MakeObservable(o.prototype)}(this.Two,"function"!=typeof require||"function"==typeof define&&define.amd?this._:require("underscore"),"function"!=typeof require||"function"==typeof define&&define.amd?this.Backbone:require("backbone"),"function"!=typeof require||"function"==typeof define&&define.amd?this.requestAnimationFrame:require("requestAnimationFrame")),function(t,e,i,r){var n=t.Utils.getComputedMatrix,s=document.createElement("canvas");s.getContext("2d");t.Text=function(i,r,n,s){return t.Shape.call(this),this._renderer.type="text",this.value=i,e.isNumber(r)&&(this.translation.x=r),e.isNumber(n)&&(this.translation.y=n),e.isObject(s)?void e.each(t.Text.Properties,function(t){t in s&&(this[t]=s[t])},this):this},e.extend(t.Text,{Properties:["value","family","size","leading","alignment","fill","stroke","linewidth","style","weight","decoration","baseline","opacity","visible"],MakeObservable:function(i){t.Shape.MakeObservable(i),e.each(t.Text.Properties,function(t){var e="_"+t,r="_flag"+t.charAt(0).toUpperCase()+t.slice(1);Object.defineProperty(i,t,{get:function(){return this[e]},set:function(t){this[e]=t,this[r]=!0}})}),Object.defineProperty(i,"clip",{get:function(){return this._clip},set:function(t){this._clip=t,this._flagClip=!0}})}}),e.extend(t.Text.prototype,t.Shape.prototype,{_flagValue:!0,_flagFamily:!0,_flagSize:!0,_flagLeading:!0,_flagAlignment:!0,_flagBaseline:!0,_flagStyle:!0,_flagWeight:!0,_flagDecoration:!0,_flagFill:!0,_flagStroke:!0,_flagLinewidth:!0,_flagOpacity:!0,_flagVisible:!0,_flagClip:!1,_value:"",_family:"sans-serif",_size:13,_leading:17,_alignment:"center",_baseline:"middle",_style:"normal",_weight:500,_decoration:"none",_fill:"#000",_stroke:"transparent",_linewidth:1,_opacity:1,_visible:!0,_clip:!1,clone:function(i){var i=i||this.parent,r=new t.Text(this.value);return r.translation.copy(this.translation),r.rotation=this.rotation,r.scale=this.scale,e.each(t.Text.Properties,function(t){r[t]=this[t]},this),i.add(r),r},toObject:function(){var i={translation:this.translation.toObject(),rotation:this.rotation,scale:this.scale};return e.each(t.Text.Properties,function(t){i[t]=this[t]},this),i},noStroke:function(){return this.stroke="transparent",this},noFill:function(){return this.fill="transparent",this},getBoundingClientRect:function(t){var e,i;return this._update(!0),e=t?this._matrix:n(this),i=e.multiply(0,0,1),{top:i.x,left:i.y,right:i.x,bottom:i.y,width:0,height:0}},flagReset:function(){return this._flagValue=this._flagFamily=this._flagSize=this._flagLeading=this._flagAlignment=this._flagFill=this._flagStroke=this._flagLinewidth=this._flagOpaicty=this._flagVisible=this._flagClip=this._flagDecoration=this._flagBaseline=!1,t.Shape.prototype.flagReset.call(this),this}}),t.Text.MakeObservable(t.Text.prototype)}(Two,"function"!=typeof require||"function"==typeof define&&define.amd?_:require("underscore"),"function"!=typeof require||"function"==typeof define&&define.amd?Backbone:require("backbone"),"function"!=typeof require||"function"==typeof define&&define.amd?requestAnimationFrame:require("requestAnimationFrame")),function(t,e,i,r){var n=t.Stop=function(t,i,r){this._renderer={},this.offset=e.isNumber(t)?t:n.Index<=0?0:1,this.opacity=e.isNumber(r)?r:1,this.color=e.isString(i)?i:n.Index<=0?"#fff":"#000",n.Index=(n.Index+1)%2};e.extend(n,{Index:0,Properties:["offset","opacity","color"],MakeObservable:function(i){e.each(n.Properties,function(e){var r="_"+e,n="_flag"+e.charAt(0).toUpperCase()+e.slice(1);Object.defineProperty(i,e,{get:function(){return this[r]},set:function(e){this[r]=e,this[n]=!0,this.trigger(t.Events.change)}})})}}),e.extend(n.prototype,i.Events,{clone:function(){var t=new n;return e.each(n.Properties,function(e){t[e]=this[e]},this),t},toObject:function(){var t={};return e.each(n.Properties,function(e){t[e]=this[e]},this),t},flagReset:function(){return this._flagOffset=this._flagColor=this._flagOpacity=!1,this}}),n.MakeObservable(n.prototype);var s=t.Gradient=function(e){t.Shape.call(this),this._renderer.type="gradient",this.spread="pad",this.stops=e};e.extend(s,{Stop:n,Properties:["spread"],MakeObservable:function(i){t.Shape.MakeObservable(i),e.each(s.Properties,t.Utils.defineProperty,i),Object.defineProperty(i,"stops",{get:function(){return this._stops},set:function(i){var r=e.bind(s.FlagStops,this),n=e.bind(function(e){for(var i=e.length;i--;)e[i].bind(t.Events.change,r);r()},this),a=e.bind(function(i){e.each(i,function(e){e.unbind(t.Events.change,r)},this),r()},this);this._stops&&this._stops.unbind(),this._stops=new t.Utils.Collection((i||[]).slice(0)),this._stops.bind(t.Events.insert,n),this._stops.bind(t.Events.remove,a),n(this._stops)}})},FlagStops:function(){this._flagStops=!0}}),e.extend(s.prototype,t.Shape.prototype,{clone:function(i){i=i||this.parent;var r=e.map(this.stops,function(t){return t.clone()}),n=new s(r);return e.each(t.Gradient.Properties,function(t){n[t]=this[t]},this),n.translation.copy(this.translation),n.rotation=this.rotation,n.scale=this.scale,i.add(n),n},toObject:function(){var t={stops:e.map(this.stops,function(t){return t.toObject()})};return e.each(s.Properties,function(e){t[e]=this[e]},this),t},flagReset:function(){return this._flagSpread=this._flagStops=!1,t.Shape.prototype.flagReset.call(this),this}}),s.MakeObservable(s.prototype)}(this.Two,"function"!=typeof require||"function"==typeof define&&define.amd?this._:require("underscore"),"function"!=typeof require||"function"==typeof define&&define.amd?this.Backbone:require("backbone"),"function"!=typeof require||"function"==typeof define&&define.amd?this.requestAnimationFrame:require("requestAnimationFrame")),function(t,e,i,r){var n=t.LinearGradient=function(i,r,s,a,o){t.Gradient.call(this,o),this._renderer.type="linear-gradient";var l=e.bind(n.FlagEndPoints,this);this.left=(new t.Vector).bind(t.Events.change,l),this.right=(new t.Vector).bind(t.Events.change,l),e.isNumber(i)&&(this.left.x=i),e.isNumber(r)&&(this.left.y=r),e.isNumber(s)&&(this.right.x=s),e.isNumber(a)&&(this.right.y=a)};e.extend(n,{Stop:t.Gradient.Stop,MakeObservable:function(e){t.Gradient.MakeObservable(e)},FlagEndPoints:function(){this._flagEndPoints=!0}}),e.extend(n.prototype,t.Gradient.prototype,{_flagEndPoints:!1,clone:function(i){i=i||this.parent;var r=e.map(this.stops,function(t){return t.clone()}),s=new n(this.left._x,this.left._y,this.right._x,this.right._y,r);return e.each(t.Gradient.Properties,function(t){s[t]=this[t]},this),i.add(s),s},toObject:function(){var e=t.Gradient.prototype.toObject.call(this);return e.left=this.left.toObject(),e.right=this.right.toObject(),e},flagReset:function(){return this._flagEndPoints=!1,t.Gradient.prototype.flagReset.call(this),this}}),n.MakeObservable(n.prototype)}(this.Two,"function"!=typeof require||"function"==typeof define&&define.amd?this._:require("underscore"),"function"!=typeof require||"function"==typeof define&&define.amd?this.Backbone:require("backbone"),"function"!=typeof require||"function"==typeof define&&define.amd?this.requestAnimationFrame:require("requestAnimationFrame")),function(t,e,i,r){var n=t.RadialGradient=function(i,r,n,s,a,o){t.Gradient.call(this,s),this._renderer.type="radial-gradient",this.center=(new t.Vector).bind(t.Events.change,e.bind(function(){this._flagCenter=!0},this)),this.radius=e.isNumber(n)?n:20,this.focal=(new t.Vector).bind(t.Events.change,e.bind(function(){this._flagFocal=!0},this)),e.isNumber(i)&&(this.center.x=i),e.isNumber(r)&&(this.center.y=r),this.focal.copy(this.center),e.isNumber(a)&&(this.focal.x=a),e.isNumber(o)&&(this.focal.y=o)};e.extend(n,{Stop:t.Gradient.Stop,Properties:["radius"],MakeObservable:function(i){t.Gradient.MakeObservable(i),e.each(n.Properties,t.Utils.defineProperty,i)}}),e.extend(n.prototype,t.Gradient.prototype,{_flagEndPoints:!1,clone:function(i){i=i||this.parent;var r=e.map(this.stops,function(t){return t.clone()}),s=new n(this.center._x,this.center._y,this._radius,r,this.focal._x,this.focal._y);return e.each(t.Gradient.Properties.concat(n.Properties),function(t){s[t]=this[t]},this),i.add(s),s},toObject:function(){var i=t.Gradient.prototype.toObject.call(this);return e.each(n.Properties,function(t){i[t]=this[t]},this),i.center=this.center.toObject(),i.focal=this.focal.toObject(),i},flagReset:function(){return this._flagRadius=this._flagCenter=this._flagFocal=!1,t.Gradient.prototype.flagReset.call(this),this}}),n.MakeObservable(n.prototype)}(this.Two,"function"!=typeof require||"function"==typeof define&&define.amd?this._:require("underscore"),"function"!=typeof require||"function"==typeof define&&define.amd?this.Backbone:require("backbone"),"function"!=typeof require||"function"==typeof define&&define.amd?this.requestAnimationFrame:require("requestAnimationFrame")),function(t,e,i,r){function n(t,i){var r,n=t.parent;return n&&n.children.ids[t.id]&&(r=e.indexOf(n.children,t),n.children.splice(r,1),r=e.indexOf(n.additions,t),r>=0?n.additions.splice(r,1):(n.subtractions.push(t),n._flagSubtractions=!0)),i?(t.parent=i,this.additions.push(t),void(this._flagAdditions=!0)):(r=e.indexOf(this.additions,t),r>=0?this.additions.splice(r,1):(this.subtractions.push(t),this._flagSubtractions=!0),void delete t.parent)}var s=Math.min,a=Math.max,o=function(){t.Utils.Collection.apply(this,arguments),Object.defineProperty(this,"_events",{value:{},enumerable:!1}),this.ids={},this.on(t.Events.insert,this.attach),this.on(t.Events.remove,this.detach),o.prototype.attach.apply(this,arguments)};o.prototype=new t.Utils.Collection,o.constructor=o,e.extend(o.prototype,{attach:function(t){for(var e=0;e<t.length;e++)this.ids[t[e].id]=t[e];return this},detach:function(t){for(var e=0;e<t.length;e++)delete this.ids[t[e].id];return this}});var l=t.Group=function(){t.Shape.call(this,!0),this._renderer.type="group",this.additions=[],this.subtractions=[],this._children=[],this.children=arguments};e.extend(l,{Children:o,InsertChildren:function(t){for(var e=0;e<t.length;e++)n.call(this,t[e],this)},RemoveChildren:function(t){for(var e=0;e<t.length;e++)n.call(this,t[e])},OrderChildren:function(t){this._flagOrder=!0},MakeObservable:function(i){var r=t.Path.Properties.slice(0),n=e.indexOf(r,"opacity");n>=0&&(r.splice(n,1),Object.defineProperty(i,"opacity",{get:function(){return this._opacity},set:function(t){this._flagOpacity=this._opacity!=t,this._opacity=t}})),t.Shape.MakeObservable(i),l.MakeGetterSetters(i,r),Object.defineProperty(i,"children",{get:function(){return this._collection},set:function(i){var r=e.bind(l.InsertChildren,this),n=e.bind(l.RemoveChildren,this),s=e.bind(l.OrderChildren,this);this._collection&&this._collection.unbind(),this._collection=new o(i),this._collection.bind(t.Events.insert,r),this._collection.bind(t.Events.remove,n),this._collection.bind(t.Events.order,s)}}),Object.defineProperty(i,"mask",{get:function(){return this._mask},set:function(t){this._mask=t,this._flagMask=!0,t.clip||(t.clip=!0)}})},MakeGetterSetters:function(t,i){e.isArray(i)||(i=[i]),e.each(i,function(e){l.MakeGetterSetter(t,e)})},MakeGetterSetter:function(t,i){var r="_"+i;Object.defineProperty(t,i,{get:function(){return this[r]},set:function(t){this[r]=t,e.each(this.children,function(e){e[i]=t})}})}}),e.extend(l.prototype,t.Shape.prototype,{_flagAdditions:!1,_flagSubtractions:!1,_flagOrder:!1,_flagOpacity:!0,_flagMask:!1,_fill:"#fff",_stroke:"#000",_linewidth:1,_opacity:1,_visible:!0,_cap:"round",_join:"round",_miter:4,_closed:!0,_curved:!1,_automatic:!0,_beginning:0,_ending:1,_mask:null,clone:function(t){t=t||this.parent;var i=new l;t.add(i);e.map(this.children,function(t){return t.clone(i)});return i.translation.copy(this.translation),i.rotation=this.rotation,i.scale=this.scale,i},toObject:function(){var t={children:{},translation:this.translation.toObject(),rotation:this.rotation,scale:this.scale};return e.each(this.children,function(e,i){t.children[i]=e.toObject()},this),t},corner:function(){var t=this.getBoundingClientRect(!0),e={x:t.left,y:t.top};return this.children.forEach(function(t){t.translation.subSelf(e)}),this},center:function(){var t=this.getBoundingClientRect(!0);return t.centroid={x:t.left+t.width/2,y:t.top+t.height/2},this.children.forEach(function(e){e.translation.subSelf(t.centroid)}),this},getById:function(t){var e=function(t,i){if(t.id===i)return t;if(t.children)for(var r=t.children.length;r--;){var n=e(t.children[r],i);if(n)return n}};return e(this,t)||null},getByClassName:function(t){var e=[],i=function(t,r){return t.classList.indexOf(r)!=-1?e.push(t):t.children&&t.children.forEach(function(t){i(t,r)}),e};return i(this,t)},getByType:function(e){var i=[],r=function(e,n){for(var s in e.children)e.children[s]instanceof n?i.push(e.children[s]):e.children[s]instanceof t.Group&&r(e.children[s],n);return i};return r(this,e)},add:function(t){t=t instanceof Array?t.slice():e.toArray(arguments);for(var i=0;i<t.length;i++)t[i]&&t[i].id&&this.children.push(t[i]);return this},remove:function(t){var i=arguments.length,r=this.parent;if(i<=0&&r)return r.remove(this),this;t=t instanceof Array?t.slice():e.toArray(arguments);for(var n=0;n<t.length;n++)t[n]&&this.children.ids[t[n].id]&&this.children.splice(e.indexOf(this.children,t[n]),1);return this},getBoundingClientRect:function(t){var i;this._update(!0);var r=1/0,n=-(1/0),o=1/0,l=-(1/0);return this.children.forEach(function(h){/(linear-gradient|radial-gradient|gradient)/.test(h._renderer.type)||(i=h.getBoundingClientRect(t),e.isNumber(i.top)&&e.isNumber(i.left)&&e.isNumber(i.right)&&e.isNumber(i.bottom)&&(o=s(i.top,o),r=s(i.left,r),n=a(i.right,n),l=a(i.bottom,l)))},this),{top:o,left:r,right:n,bottom:l,width:n-r,height:l-o}},noFill:function(){return this.children.forEach(function(t){t.noFill()}),this},noStroke:function(){return this.children.forEach(function(t){t.noStroke()}),this},subdivide:function(){var t=arguments;return this.children.forEach(function(e){e.subdivide.apply(e,t)}),this},flagReset:function(){return this._flagAdditions&&(this.additions.length=0,this._flagAdditions=!1),this._flagSubtractions&&(this.subtractions.length=0,this._flagSubtractions=!1),this._flagOrder=this._flagMask=this._flagOpacity=!1,t.Shape.prototype.flagReset.call(this),this}}),l.MakeObservable(l.prototype)}(this.Two,"function"!=typeof require||"function"==typeof define&&define.amd?this._:require("underscore"),"function"!=typeof require||"function"==typeof define&&define.amd?this.Backbone:require("backbone"),"function"!=typeof require||"function"==typeof define&&define.amd?this.requestAnimationFrame:require("requestAnimationFrame"));